<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dashboard CHT22 - Origem e Conversão</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Inter', sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            color: #333;
        }

        .dashboard-container {
            max-width: 1600px;
            margin: 0 auto;
            padding: 20px;
        }

        /* Header */
        .header {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(20px);
            border-radius: 20px;
            padding: 25px 35px;
            margin-bottom: 25px;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .header-left h1 {
            font-size: 2.2rem;
            font-weight: 800;
            background: linear-gradient(135deg, #667eea, #764ba2);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            margin-bottom: 5px;
        }

        .header-left .subtitle {
            color: #666;
            font-size: 1rem;
            font-weight: 500;
        }

        .header-right {
            display: flex;
            align-items: center;
            gap: 20px;
        }

        .status-badge {
            display: flex;
            align-items: center;
            gap: 8px;
            padding: 12px 20px;
            background: linear-gradient(135deg, #28a745, #20c997);
            color: white;
            border-radius: 25px;
            font-weight: 600;
            font-size: 0.9rem;
        }

        /* Navigation Tabs */
        .nav-tabs {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(20px);
            border-radius: 20px;
            padding: 8px;
            margin-bottom: 25px;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1);
            display: flex;
            gap: 5px;
            overflow-x: auto;
        }

        .nav-tab {
            flex: 1;
            min-width: 180px;
            padding: 15px 20px;
            text-align: center;
            border-radius: 15px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-weight: 600;
            font-size: 0.9rem;
            color: #666;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
        }

        .nav-tab.active {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            box-shadow: 0 10px 20px rgba(102, 126, 234, 0.3);
        }

        .nav-tab:hover:not(.active) {
            background: rgba(102, 126, 234, 0.1);
            color: #667eea;
        }

        /* Page Title */
        .page-title {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(20px);
            border-radius: 20px;
            padding: 25px 35px;
            margin-bottom: 25px;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1);
            border-left: 6px solid #17a2b8;
        }

        .page-title h2 {
            font-size: 1.8rem;
            font-weight: 700;
            color: #333;
            margin-bottom: 8px;
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .page-title p {
            color: #666;
            font-size: 1rem;
            line-height: 1.6;
        }

        /* Summary Cards */
        .summary-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .summary-card {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(20px);
            border-radius: 20px;
            padding: 25px;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1);
            text-align: center;
            position: relative;
            overflow: hidden;
        }

        .summary-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: var(--card-color);
        }

        .summary-icon {
            width: 60px;
            height: 60px;
            border-radius: 15px;
            background: var(--card-color);
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
            margin: 0 auto 15px;
        }

        .summary-value {
            font-size: 2.2rem;
            font-weight: 800;
            color: #333;
            margin-bottom: 8px;
        }

        .summary-label {
            color: #666;
            font-size: 1rem;
            font-weight: 600;
            margin-bottom: 10px;
        }

        .summary-trend {
            font-size: 0.85rem;
            font-weight: 600;
            padding: 5px 10px;
            border-radius: 15px;
            display: inline-block;
        }

        .trend-good { background: rgba(40, 167, 69, 0.1); color: #28a745; }
        .trend-warning { background: rgba(255, 193, 7, 0.1); color: #ffc107; }
        .trend-danger { background: rgba(220, 53, 69, 0.1); color: #dc3545; }

        /* Tab Content Styles */
        .tab-content {
            display: none;
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(20px);
            border-radius: 20px;
            padding: 25px 35px;
            margin-bottom: 25px;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1);
        }

        .tab-content.active {
            display: block;
        }

        /* Executive Summary Styles */
        .executive-summary {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        /* Insights Section */
        .insights-section h3 {
            color: #2c3e50;
            margin-bottom: 20px;
            font-size: 1.3rem;
        }

        .insights-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
        }

        .insight-card {
            background: white;
            border-radius: 12px;
            padding: 20px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            border-left: 4px solid;
        }

        .insight-card.excellent { border-left-color: #28a745; }
        .insight-card.warning { border-left-color: #ffc107; }
        .insight-card.good { border-left-color: #17a2b8; }

        .insight-card .insight-icon {
            font-size: 1.5rem;
            margin-bottom: 10px;
        }

        .insight-card h4 {
            margin: 0 0 10px 0;
            color: #2c3e50;
        }

        /* Segments Grid */
        .segments-grid, .regional-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
        }

        .segment-card, .region-card {
            background: white;
            border-radius: 12px;
            padding: 20px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }

        .segment-header, .region-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }

        .segment-percentage, .region-percentage {
            background: linear-gradient(135deg, #6f42c1, #5a32a3);
            color: white;
            padding: 5px 12px;
            border-radius: 20px;
            font-weight: 600;
        }

        .segment-metrics, .region-metrics {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(100px, 1fr));
            gap: 15px;
        }

        .metric {
            text-align: center;
        }

        .metric-label {
            display: block;
            font-size: 0.8rem;
            color: #6c757d;
            margin-bottom: 5px;
        }

        .metric-value {
            display: block;
            font-size: 1.2rem;
            font-weight: 600;
            color: #2c3e50;
        }

        /* AI Insights */
        .ai-insights-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
            gap: 20px;
        }

        .ai-card {
            background: white;
            border-radius: 12px;
            padding: 20px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            border-left: 4px solid;
        }

        .ai-card.critical { border-left-color: #dc3545; }
        .ai-card.opportunity { border-left-color: #28a745; }
        .ai-card.optimization { border-left-color: #17a2b8; }
        .ai-card.prediction { border-left-color: #6f42c1; }
        .ai-card.warning { border-left-color: #ffc107; }
        .ai-card.success { border-left-color: #20c997; }

        .ai-icon {
            font-size: 1.5rem;
            margin-bottom: 10px;
        }

        .ai-content h3 {
            margin: 0 0 10px 0;
            color: #2c3e50;
        }

        .ai-action {
            margin-top: 15px;
        }

        .btn-action {
            padding: 8px 16px;
            border: none;
            border-radius: 6px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .btn-action.critical { background: #dc3545; color: white; }
        .btn-action.opportunity { background: #28a745; color: white; }
        .btn-action.optimization { background: #17a2b8; color: white; }
        .btn-action.prediction { background: #6f42c1; color: white; }
        .btn-action.warning { background: #ffc107; color: #333; }
        .btn-action.success { background: #20c997; color: white; }

        /* Projections */
        .projections-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
        }

        .projection-card {
            background: white;
            border-radius: 12px;
            padding: 20px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            border-left: 4px solid;
        }

        .projection-card.pessimistic { border-left-color: #dc3545; }
        .projection-card.realistic { border-left-color: #17a2b8; }
        .projection-card.optimistic { border-left-color: #28a745; }

        .projection-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }

        .probability {
            background: rgba(108, 117, 125, 0.1);
            color: #6c757d;
            padding: 4px 8px;
            border-radius: 12px;
            font-size: 0.8rem;
        }

        .projection-metrics {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 15px;
        }

        /* Projection Summary and Tables */
        .projection-summary {
            margin-bottom: 30px;
        }

        .summary-card {
            background: white;
            border-radius: 12px;
            padding: 20px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            border-left: 4px solid #6f42c1;
        }

        .premissas-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-top: 15px;
        }

        .premissa-item {
            display: flex;
            flex-direction: column;
            text-align: center;
        }

        .premissa-label {
            font-size: 0.8rem;
            color: #6c757d;
            margin-bottom: 5px;
        }

        .premissa-value {
            font-size: 1.1rem;
            font-weight: 600;
            color: #2c3e50;
        }

        .projection-table-container, .result-table-container {
            background: white;
            border-radius: 12px;
            overflow: hidden;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            margin-bottom: 20px;
        }

        .projection-table, .result-table {
            width: 100%;
            border-collapse: collapse;
        }

        .projection-table th, .result-table th {
            background: linear-gradient(135deg, #6f42c1, #5a32a3);
            color: white;
            padding: 15px;
            text-align: center;
            font-weight: 600;
        }

        .projection-table td, .result-table td {
            padding: 12px 15px;
            text-align: center;
            border-bottom: 1px solid #e9ecef;
        }

        .section-header td {
            background: linear-gradient(135deg, #17a2b8, #138496);
            color: white;
            font-weight: 600;
            text-align: left;
            padding: 10px 15px;
        }

        .performance-value {
            background: rgba(40, 167, 69, 0.1);
            color: #28a745;
            font-weight: 600;
        }

        .projection-value {
            background: rgba(23, 162, 184, 0.1);
            color: #17a2b8;
            font-weight: 600;
        }

        .potential-value {
            background: rgba(111, 66, 193, 0.1);
            color: #6f42c1;
            font-weight: 600;
        }

        .result-value {
            background: rgba(255, 193, 7, 0.1);
            color: #856404;
            font-weight: 600;
        }

        .result-summary {
            margin-bottom: 30px;
        }

        .result-summary h3 {
            color: #2c3e50;
            margin-bottom: 15px;
            padding: 10px 0;
            border-bottom: 2px solid #e9ecef;
        }

        .result-note {
            font-style: italic;
            color: #6c757d;
            margin-top: 10px;
            text-align: center;
        }

        /* Channel Performance Grid */
        .channel-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(320px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .channel-card {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(20px);
            border-radius: 20px;
            padding: 25px;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1);
            transition: transform 0.3s ease;
            position: relative;
            overflow: hidden;
        }

        .channel-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: var(--channel-color);
        }

        .channel-card:hover {
            transform: translateY(-5px);
        }

        .channel-header {
            display: flex;
            align-items: center;
            gap: 15px;
            margin-bottom: 20px;
        }

        .channel-icon {
            width: 50px;
            height: 50px;
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 1.3rem;
            background: var(--channel-color);
        }

        .channel-info h3 {
            font-size: 1.3rem;
            font-weight: 700;
            color: #333;
            margin-bottom: 3px;
        }

        .channel-info span {
            color: #666;
            font-size: 0.9rem;
        }

        .channel-metrics {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 15px;
            margin-bottom: 20px;
        }

        .metric-item {
            text-align: center;
            padding: 15px;
            background: rgba(0, 0, 0, 0.02);
            border-radius: 12px;
        }

        .metric-value {
            font-size: 1.6rem;
            font-weight: 700;
            color: #333;
            margin-bottom: 5px;
        }

        .metric-label {
            font-size: 0.8rem;
            color: #666;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .channel-performance {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 12px 15px;
            background: rgba(0, 0, 0, 0.02);
            border-radius: 12px;
        }

        .performance-badge {
            padding: 6px 12px;
            border-radius: 15px;
            font-size: 0.8rem;
            font-weight: 600;
        }

        .excellent { background: rgba(40, 167, 69, 0.1); color: #28a745; }
        .good { background: rgba(23, 162, 184, 0.1); color: #17a2b8; }
        .warning { background: rgba(255, 193, 7, 0.1); color: #ffc107; }
        .poor { background: rgba(220, 53, 69, 0.1); color: #dc3545; }

        /* Channel Colors */
        .facebook { --channel-color: #1877f2; }
        .instagram { --channel-color: #e4405f; }
        .google { --channel-color: #4464f4; }
        .youtube { --channel-color: #ff0000; }
        .email { --channel-color: #28a745; }
        .outros { --channel-color: #6c757d; }

        /* Summary Card Colors */
        .total-leads { --card-color: linear-gradient(135deg, #6f42c1, #5a32a3); }
        .avg-cpl { --card-color: linear-gradient(135deg, #17a2b8, #138496); }
        .total-investment { --card-color: linear-gradient(135deg, #fd7e14, #e8590c); }
        .conversion-rate { --card-color: linear-gradient(135deg, #28a745, #20c997); }

        /* KPIs e Premissas Section */
        .kpis-section {
            margin-top: 30px;
            margin-bottom: 30px;
        }

        .kpis-section h3 {
            font-size: 1.4rem;
            font-weight: 700;
            color: #333;
            margin-bottom: 10px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .kpis-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }

        .kpi-card {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(20px);
            border-radius: 16px;
            padding: 25px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
            display: flex;
            align-items: center;
            gap: 20px;
            transition: all 0.3s ease;
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        .kpi-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.15);
        }

        .kpi-icon {
            width: 60px;
            height: 60px;
            border-radius: 16px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 1.5rem;
            flex-shrink: 0;
        }

        .kpi-content {
            flex: 1;
        }

        .kpi-value {
            font-size: 2rem;
            font-weight: 800;
            color: #333;
            margin-bottom: 5px;
            line-height: 1;
        }

        .kpi-label {
            font-size: 0.9rem;
            color: #666;
            font-weight: 600;
            margin-bottom: 8px;
        }

        .kpi-status {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .premissa-tag {
            background: rgba(111, 66, 193, 0.1);
            color: #6f42c1;
            padding: 4px 8px;
            border-radius: 8px;
            font-size: 0.75rem;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .current-value {
            background: rgba(23, 162, 184, 0.1);
            color: #17a2b8;
            padding: 4px 8px;
            border-radius: 8px;
            font-size: 0.75rem;
            font-weight: 600;
        }

        /* Charts Section */
        .charts-section {
            display: grid;
            grid-template-columns: 2fr 1fr;
            gap: 25px;
            margin-bottom: 30px;
        }

        .chart-card {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(20px);
            border-radius: 20px;
            padding: 30px;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1);
        }

        .chart-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 25px;
        }

        .chart-title {
            font-size: 1.3rem;
            font-weight: 700;
            color: #333;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .chart-subtitle {
            color: #666;
            font-size: 0.9rem;
            margin-top: 5px;
        }

        .chart-placeholder {
            height: 300px;
            background: rgba(102, 126, 234, 0.05);
            border-radius: 15px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: #666;
            text-align: center;
        }

        /* Performance Table */
        .performance-table {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(20px);
            border-radius: 20px;
            padding: 30px;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1);
            overflow-x: auto;
        }

        .table-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 25px;
        }

        .table-title {
            font-size: 1.3rem;
            font-weight: 700;
            color: #333;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .data-table {
            width: 100%;
            border-collapse: collapse;
            font-size: 0.9rem;
        }

        .data-table th {
            background: rgba(102, 126, 234, 0.1);
            color: #333;
            font-weight: 700;
            padding: 15px 12px;
            text-align: left;
            border-bottom: 2px solid rgba(102, 126, 234, 0.2);
        }

        .data-table td {
            padding: 12px;
            border-bottom: 1px solid rgba(0, 0, 0, 0.05);
        }

        .data-table tr:hover {
            background: rgba(102, 126, 234, 0.02);
        }

        /* Profession Table Styles */
        .profession-table-container {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(20px);
            border-radius: 20px;
            padding: 30px;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1);
            overflow-x: auto;
            margin-bottom: 30px;
        }

        .profession-table {
            width: 100%;
            border-collapse: collapse;
            font-size: 0.85rem;
        }

        .profession-table th {
            background: linear-gradient(135deg, #6f42c1, #5a32a3);
            color: white;
            font-weight: 700;
            padding: 12px 8px;
            text-align: center;
            font-size: 0.8rem;
        }

        .profession-table td {
            padding: 10px 8px;
            text-align: center;
            border-bottom: 1px solid rgba(0, 0, 0, 0.05);
        }

        .profession-row:hover {
            background: rgba(111, 66, 193, 0.02);
        }

        .profession-name {
            text-align: left !important;
            font-weight: 600;
            min-width: 150px;
        }

        .profession-name i {
            margin-right: 8px;
            color: #6f42c1;
        }

        .channel-value {
            font-weight: 600;
            color: #333;
        }

        .channel-percent {
            color: #666;
            font-size: 0.8rem;
        }

        .highlight {
            background: rgba(24, 119, 242, 0.1);
            color: #1877f2 !important;
            font-weight: 700;
        }

        .total-value {
            font-weight: 700;
            color: #6f42c1;
            background: rgba(111, 66, 193, 0.1);
        }

        .total-percent {
            font-weight: 700;
            color: #6f42c1;
            background: rgba(111, 66, 193, 0.1);
        }

        .total-row {
            background: rgba(111, 66, 193, 0.1);
            font-weight: 700;
        }

        .total-row td {
            border-top: 2px solid #6f42c1;
            color: #6f42c1;
        }

        /* Profession Insights */
        .profession-insights {
            margin-top: 30px;
        }

        .profession-insights h3 {
            font-size: 1.4rem;
            font-weight: 700;
            color: #333;
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        /* Avatar Badges */
        .avatar-badge {
            background: linear-gradient(135deg, #28a745, #20c997);
            color: white;
            padding: 2px 6px;
            border-radius: 4px;
            font-size: 0.6rem;
            font-weight: 700;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            margin-left: 8px;
        }

        .fora-badge {
            background: linear-gradient(135deg, #ffc107, #e0a800);
            color: #333;
            padding: 2px 6px;
            border-radius: 4px;
            font-size: 0.6rem;
            font-weight: 700;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            margin-left: 8px;
        }

        .secundario-badge {
            background: linear-gradient(135deg, #17a2b8, #138496);
            color: white;
            padding: 2px 6px;
            border-radius: 4px;
            font-size: 0.6rem;
            font-weight: 700;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            margin-left: 8px;
        }

        .avatar-ideal {
            background: rgba(40, 167, 69, 0.05);
            border-left: 4px solid #28a745;
        }

        .avatar-secundario {
            background: rgba(23, 162, 184, 0.05);
            border-left: 4px solid #17a2b8;
        }

        .fora-avatar {
            background: rgba(255, 193, 7, 0.05);
            border-left: 4px solid #ffc107;
        }

        .avatar-total {
            background: rgba(40, 167, 69, 0.2) !important;
            color: #28a745 !important;
            font-weight: 800;
        }

        .secundario-total {
            background: rgba(23, 162, 184, 0.2) !important;
            color: #17a2b8 !important;
            font-weight: 700;
        }

        .fora-total {
            background: rgba(255, 193, 7, 0.2) !important;
            color: #e0a800 !important;
            font-weight: 600;
        }

        /* Strategic Recommendations */
        .strategic-recommendations {
            margin-top: 30px;
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(20px);
            border-radius: 16px;
            padding: 25px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
        }

        .strategic-recommendations h4 {
            font-size: 1.2rem;
            font-weight: 700;
            color: #333;
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .recommendations-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 20px;
        }

        .recommendation-card {
            display: flex;
            align-items: flex-start;
            gap: 15px;
            padding: 20px;
            border-radius: 12px;
            border-left: 4px solid;
        }

        .priority-high {
            background: rgba(220, 53, 69, 0.05);
            border-left-color: #dc3545;
        }

        .priority-medium {
            background: rgba(255, 193, 7, 0.05);
            border-left-color: #ffc107;
        }

        .priority-low {
            background: rgba(23, 162, 184, 0.05);
            border-left-color: #17a2b8;
        }

        .rec-icon {
            width: 40px;
            height: 40px;
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 1.2rem;
            flex-shrink: 0;
        }

        .priority-high .rec-icon {
            background: linear-gradient(135deg, #dc3545, #c82333);
        }

        .priority-medium .rec-icon {
            background: linear-gradient(135deg, #ffc107, #e0a800);
        }

        .priority-low .rec-icon {
            background: linear-gradient(135deg, #17a2b8, #138496);
        }

        .rec-content h5 {
            font-size: 0.8rem;
            font-weight: 700;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            margin-bottom: 8px;
            color: #666;
        }

        .rec-content p {
            font-size: 0.9rem;
            line-height: 1.4;
            color: #333;
            margin: 0;
        }

        .rec-content strong {
            color: #333;
            font-weight: 700;
        }

        /* Construction Styles */
        .construction-container {
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 400px;
            padding: 40px 20px;
        }

        .construction-card {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(20px);
            border-radius: 20px;
            padding: 50px 40px;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1);
            text-align: center;
            max-width: 500px;
            width: 100%;
        }

        .construction-icon {
            width: 80px;
            height: 80px;
            background: linear-gradient(135deg, #ffc107, #e0a800);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 auto 25px;
            font-size: 2rem;
            color: white;
            animation: bounce 2s infinite;
        }

        @keyframes bounce {
            0%, 20%, 50%, 80%, 100% {
                transform: translateY(0);
            }
            40% {
                transform: translateY(-10px);
            }
            60% {
                transform: translateY(-5px);
            }
        }

        .construction-card h3 {
            font-size: 1.8rem;
            font-weight: 700;
            color: #333;
            margin-bottom: 15px;
        }

        .construction-card p {
            font-size: 1.1rem;
            color: #666;
            margin-bottom: 30px;
            line-height: 1.5;
        }

        .construction-details {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 15px;
            margin-top: 30px;
        }

        .feature-item {
            display: flex;
            align-items: center;
            gap: 10px;
            padding: 12px 15px;
            background: rgba(255, 193, 7, 0.1);
            border-radius: 10px;
            color: #666;
            font-size: 0.9rem;
        }

        .feature-item i {
            color: #ffc107;
            font-size: 1.1rem;
        }

        @media (max-width: 768px) {
            .construction-details {
                grid-template-columns: 1fr;
            }
            
            .construction-card {
                padding: 30px 20px;
            }
        }

        .table-metric {
            font-weight: 600;
            color: #333;
        }

        /* Responsive */
        @media (max-width: 1200px) {
            .charts-section {
                grid-template-columns: 1fr;
            }
        }

        @media (max-width: 768px) {
            .dashboard-container {
                padding: 15px;
            }
            
            .header {
                flex-direction: column;
                gap: 15px;
                text-align: center;
            }
            
            .nav-tabs {
                flex-direction: column;
            }
            
            .channel-grid {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="dashboard-container">
        <!-- Header -->
        <header class="header">
            <div class="header-left">
                <h1><i class="fas fa-chart-line"></i> Dashboard Nanda Mac IA</h1>
                <div class="subtitle">Lançamento Tradicional - CHT22</div>
            </div>
            <div class="header-right">
                <div class="status-badge">
                    <div style="width: 8px; height: 8px; background: white; border-radius: 50%; animation: pulse 2s infinite;"></div>
                    <span>Dados Atualizados</span>
                </div>
                <div style="text-align: right; color: #666; font-size: 0.9rem;">
                    <div>Última atualização</div>
                    <div style="font-weight: 600;" id="last-update-time">09/09/2025 19:15</div>
                </div>
            </div>
        </header>

        <!-- Navigation Tabs -->
        <nav class="nav-tabs">
            <div class="nav-tab active">
                <i class="fas fa-tachometer-alt"></i>
                <span>Visão Geral</span>
            </div>
            <div class="nav-tab">
                <i class="fas fa-funnel-dollar"></i>
                <span>Origem e Conversão</span>
            </div>
            <div class="nav-tab">
                <i class="fas fa-user-md"></i>
                <span>Profissão por Canal</span>
            </div>
            <div class="nav-tab">
                <i class="fas fa-map-marked-alt"></i>
                <span>Análise Regional</span>
            </div>
            <div class="nav-tab">
                <i class="fas fa-brain"></i>
                <span>Insights de IA</span>
            </div>
            <div class="nav-tab">
                <i class="fas fa-chart-line"></i>
                <span>Projeção de Resultados</span>
            </div>
        </nav>

        <!-- Tab Contents -->
        
        <!-- Visão Geral Tab -->
        <div class="tab-content active" id="visao-geral" style="display: block;">
            <div class="page-title">
                <h2>
                    <i class="fas fa-tachometer-alt"></i>
                    Visão Geral - CHT22
                </h2>
                <p>Resumo executivo do lançamento CHT22 com métricas principais e status atual da campanha.</p>
            </div>

            <!-- Executive Summary -->
            <div class="executive-summary">
                <div class="summary-card status-card">
                    <div class="summary-icon" style="background: linear-gradient(135deg, #28a745, #20c997);">
                        <i class="fas fa-rocket"></i>
                    </div>
                    <div class="summary-value">16 DIAS</div>
                    <div class="summary-label">Lançamento Ativo</div>
                    <div class="summary-trend trend-good">Em andamento</div>
                </div>

                <div class="summary-card performance-card">
                    <div class="summary-icon" style="background: linear-gradient(135deg, #17a2b8, #138496);">
                        <i class="fas fa-chart-line"></i>
                    </div>
                    <div class="summary-value">125%</div>
                    <div class="summary-label">Meta CPL</div>
                    <div class="summary-trend trend-warning">R$ 17,81 vs R$ 15,00</div>
                </div>

                <div class="summary-card budget-card">
                    <div class="summary-icon" style="background: linear-gradient(135deg, #28a745, #20c997);">
                        <i class="fas fa-chart-pie"></i>
                    </div>
                    <div class="summary-value">45%</div>
                    <div class="card-label">Orçamento Captação</div>
                    <div class="summary-trend trend-good">R$ 89.351 / R$ 200.000</div>
                </div>

                <div class="summary-card budget-total-card">
                    <div class="summary-icon" style="background: linear-gradient(135deg, #6f42c1, #563d7c);">
                        <i class="fas fa-calculator"></i>
                    </div>
                    <div class="summary-value">50%</div>
                    <div class="card-label">Orçamento + Aquecimento</div>
                    <div class="summary-trend trend-good">R$ 101.914 / R$ 203.801</div>
                </div>

                <div class="summary-card roas-card">
                    <div class="summary-icon" style="background: linear-gradient(135deg, #fd7e14, #e55a4e);">
                        <i class="fas fa-coins"></i>
                    </div>
                    <div class="summary-value">1.90</div>
                    <div class="summary-label">ROAS Geral</div>
                    <div class="summary-trend trend-good">Acima da meta</div>
                </div>
            </div>

            <!-- Key Insights -->
            <div class="insights-section">
                <h3><i class="fas fa-lightbulb"></i> Principais Insights</h3>
                <div class="insights-grid">
                    <div class="insight-card excellent">
                        <div class="insight-icon"><i class="fab fa-facebook-f"></i></div>
                        <div class="insight-content">
                            <h4>Facebook Dominante</h4>
                            <p>81.3% dos leads com ROAS de 2,33. Canal principal com excelente performance.</p>
                        </div>
                    </div>
                    
                    <div class="insight-card good">
                        <div class="insight-icon"><i class="fab fa-google"></i></div>
                        <div class="insight-content">
                            <h4>Google Bom ROAS</h4>
                            <p>ROAS de 2,63 com excelente retorno. Otimizar volume de leads para escalar.</p>
                        </div>
                    </div>
                    
                    <div class="insight-card warning">
                        <div class="insight-icon"><i class="fab fa-youtube"></i></div>
                        <div class="insight-content">
                            <h4>YouTube Precisa Otimizar</h4>
                            <p>CPL de R$ 30,81 e ROAS de 1,43. Requer otimização para melhorar retorno.</p>
                        </div>
                    </div>
                </div>
            </div>

            <!-- KPIs e Premissas Section -->
            <div class="kpis-section">
                <h3><i class="fas fa-bullseye"></i> KPIs e Premissas CHT22</h3>
                <p style="margin-bottom: 20px; color: #666;">Métricas-chave e premissas baseadas no histórico para o lançamento</p>
                
                <div class="kpis-grid">
                    <div class="kpi-card meta-leads">
                        <div class="kpi-icon" style="background: linear-gradient(135deg, #6f42c1, #5a32a3);">
                            <i class="fas fa-users"></i>
                        </div>
                        <div class="kpi-content">
                            <div class="kpi-value">9.000</div>
                            <div class="kpi-label">Meta Captação LEADs</div>
                            <div class="kpi-status">
                                <span class="current-value">Atual: 5.016 (55.7%)</span>
                            </div>
                        </div>
                    </div>

                    <div class="kpi-card taxa-conversao">
                        <div class="kpi-icon" style="background: linear-gradient(135deg, #28a745, #20c997);">
                            <i class="fas fa-percentage"></i>
                        </div>
                        <div class="kpi-content">
                            <div class="kpi-value">0,70%</div>
                            <div class="kpi-label">Taxa de Conversão</div>
                            <div class="kpi-status">
                                <span class="premissa-tag">Premissa Histórica</span>
                            </div>
                        </div>
                    </div>

                    <div class="kpi-card ticket-curso">
                        <div class="kpi-icon" style="background: linear-gradient(135deg, #17a2b8, #138496);">
                            <i class="fas fa-dollar-sign"></i>
                        </div>
                        <div class="kpi-content">
                            <div class="kpi-value">R$ 6.300</div>
                            <div class="kpi-label">Ticket Médio Curso</div>
                            <div class="kpi-status">
                                <span class="premissa-tag">Preço de Venda</span>
                            </div>
                        </div>
                    </div>

                    <div class="kpi-card vendas-mentoria">
                        <div class="kpi-icon" style="background: linear-gradient(135deg, #fd7e14, #e8590c);">
                            <i class="fas fa-star"></i>
                        </div>
                        <div class="kpi-content">
                            <div class="kpi-value">30%</div>
                            <div class="kpi-label">% Vendas Mentorias</div>
                            <div class="kpi-status">
                                <span class="premissa-tag">Upsell sobre Curso</span>
                            </div>
                        </div>
                    </div>

                    <div class="kpi-card ticket-mentoria">
                        <div class="kpi-icon" style="background: linear-gradient(135deg, #dc3545, #c82333);">
                            <i class="fas fa-crown"></i>
                        </div>
                        <div class="kpi-content">
                            <div class="kpi-value">R$ 20.000</div>
                            <div class="kpi-label">Ticket Médio Mentoria</div>
                            <div class="kpi-status">
                                <span class="premissa-tag">Preço Premium</span>
                            </div>
                        </div>
                    </div>

                    <div class="kpi-card meta-cpl">
                        <div class="kpi-icon" style="background: linear-gradient(135deg, #6c757d, #495057);">
                            <i class="fas fa-target"></i>
                        </div>
                        <div class="kpi-content">
                            <div class="kpi-value">R$ 15,00</div>
                            <div class="kpi-label">Meta CPL</div>
                            <div class="kpi-status">
                                <span class="current-value">Atual: R$ 17,81 (+19%)</span>
                            </div>
                        </div>
                    </div>

                    <div class="kpi-card meta-orcamento">
                        <div class="kpi-icon" style="background: linear-gradient(135deg, #007bff, #0056b3);">
                            <i class="fas fa-chart-pie"></i>
                        </div>
                        <div class="kpi-content">
                            <div class="kpi-value">R$ 200.000</div>
                            <div class="kpi-label">Meta Orçamento Tráfego</div>
                            <div class="kpi-status">
                                <span class="current-value">Usado: R$ 83.153 (33,7%)</span>
                            </div>
                        </div>
                    </div>

                    <div class="kpi-card seguidores-instagram">
                        <div class="kpi-icon" style="background: linear-gradient(135deg, #E4405F, #C13584);">
                            <i class="fab fa-instagram"></i>
                        </div>
                        <div class="kpi-content">
                            <div class="kpi-value">164.508</div>
                            <div class="kpi-label">Seguidores Instagram</div>
                            <div class="kpi-status">
                                <span class="current-value">Atualizado 09/09</span>
                            </div>
                        </div>
                    </div>

                    <div class="kpi-card seguidores-youtube">
                        <div class="kpi-icon" style="background: linear-gradient(135deg, #FF0000, #CC0000);">
                            <i class="fab fa-youtube"></i>
                        </div>
                        <div class="kpi-content">
                            <div class="kpi-value">640.459</div>
                            <div class="kpi-label">Seguidores YouTube</div>
                            <div class="kpi-status">
                                <span class="current-value">Atualizado 09/09</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Origem e Conversão Tab -->
        <div class="tab-content" id="origem-conversao">
            <div class="page-title">
                <h2>
                    <i class="fas fa-funnel-dollar"></i>
                    Origem e Conversão - Dados Atualizados
                </h2>
                <p>Análise detalhada de performance por canal com dados corretos da planilha. CPL R$ 17,81, investimento R$ 89.351,06 em 16 dias de captação com 5.016 leads.</p>
            </div>

        <!-- Summary Cards -->
        <div class="summary-grid">
            <div class="summary-card total-leads">
                <div class="summary-icon" style="background: linear-gradient(135deg, #6f42c1, #5a32a3);">
                    <i class="fas fa-users"></i>
                </div>
                <div class="summary-value">5.016</div>
                <div class="summary-label">Total de Leads</div>
                <div class="summary-trend trend-good">16 dias de captação</div>
            </div>

            <div class="summary-card avg-cpl">
                <div class="summary-icon" style="background: linear-gradient(135deg, #17a2b8, #138496);">
                    <i class="fas fa-dollar-sign"></i>
                </div>
                <div class="summary-value">R$ 17,81</div>
                <div class="summary-label">CPL Médio Geral</div>
                <div class="summary-trend trend-warning">Acima da meta (R$ 15,00)</div>
            </div>

            <div class="summary-card total-investment">
                <div class="summary-icon" style="background: linear-gradient(135deg, #fd7e14, #e8590c);">
                    <i class="fas fa-credit-card"></i>
                </div>
                <div class="summary-value">R$ 89.351,06</div>
                <div class="summary-label">Investimento Total</div>
                <div class="summary-trend trend-good">16 dias</div>
            </div>

            <div class="summary-card conversion-rate">
                <div class="summary-icon" style="background: linear-gradient(135deg, #28a745, #20c997);">
                    <i class="fas fa-percentage"></i>
                </div>
                <div class="summary-value">1.90</div>
                <div class="summary-label">ROAS (S87)</div>
                <div class="summary-trend trend-good">Acima da meta</div>
            </div>
        </div>

        <!-- Channel Performance Grid -->
        <div class="channel-grid">
            <!-- Facebook -->
            <div class="channel-card facebook">
                <div class="channel-header">
                    <div class="channel-icon">
                        <i class="fab fa-facebook-f"></i>
                    </div>
                    <div class="channel-info">
                        <h3>Facebook</h3>
                        <span>Canal principal - 81.3% dos leads</span>
                    </div>
                </div>
                <div class="channel-metrics">
                    <div class="metric-item">
                        <div class="metric-value">4.069</div>
                        <div class="metric-label">Leads</div>
                    </div>
                    <div class="metric-item">
                        <div class="metric-value">R$ 19,15</div>
                        <div class="metric-label">CPL Médio</div>
                    </div>
                    <div class="metric-item">
                        <div class="metric-value">R$ 70.9k</div>
                        <div class="metric-label">Investido</div>
                    </div>
                    <div class="metric-item">
                        <div class="metric-value">2,23</div>
                        <div class="metric-label">ROAS (S80)</div>
                    </div>
                </div>
                <div class="channel-performance">
                    <div class="performance-badge excellent">Excelente Performance</div>
                    <div style="font-size: 0.8rem; color: #666;">Melhor canal</div>
                </div>
            </div>

            <!-- Instagram -->
            <div class="channel-card instagram">
                <div class="channel-header">
                    <div class="channel-icon">
                        <i class="fab fa-instagram"></i>
                    </div>
                    <div class="channel-info">
                        <h3>Instagram</h3>
                        <span>Canal secundário - 0.4% dos leads</span>
                    </div>
                </div>
                <div class="channel-metrics">
                    <div class="metric-item">
                        <div class="metric-value">502</div>
                        <div class="metric-label">Leads</div>
                    </div>
                    <div class="metric-item">
                        <div class="metric-value">R$ 0,00</div>
                        <div class="metric-label">CPL Médio</div>
                    </div>
                    <div class="metric-item">
                        <div class="metric-value">R$ 0</div>
                        <div class="metric-label">Investido</div>
                    </div>
                    <div class="metric-item">
                        <div class="metric-value">∞</div>
                        <div class="metric-label">ROAS (S80)</div>
                    </div>
                </div>
                <div class="channel-performance">
                    <div class="performance-badge excellent">ROI Infinito</div>
                    <div style="font-size: 0.8rem; color: #666;">Orgânico</div>
                </div>
            </div>

            <!-- YouTube -->
            <div class="channel-card youtube">
                <div class="channel-header">
                    <div class="channel-icon">
                        <i class="fab fa-youtube"></i>
                    </div>
                    <div class="channel-info">
                        <h3>YouTube</h3>
                        <span>Canal orgânico - 6.8% dos leads</span>
                    </div>
                </div>
                <div class="channel-metrics">
                    <div class="metric-item">
                        <div class="metric-value">357</div>
                        <div class="metric-label">Leads</div>
                    </div>
                    <div class="metric-item">
                        <div class="metric-value">R$ 29,83</div>
                        <div class="metric-label">CPL Médio</div>
                    </div>
                    <div class="metric-item">
                        <div class="metric-value">R$ 9.5k</div>
                        <div class="metric-label">Investido</div>
                    </div>
                    <div class="metric-item">
                        <div class="metric-value">1,39</div>
                        <div class="metric-label">ROAS (S80)</div>
                    </div>
                </div>
                <div class="channel-performance">
                    <div class="performance-badge poor">Precisa Otimizar</div>
                    <div style="font-size: 0.8rem; color: #666;">ROAS 1,43</div>
                </div>
            </div>

            <!-- Google -->
            <div class="channel-card google">
                <div class="channel-header">
                    <div class="channel-icon">
                        <i class="fab fa-google"></i>
                    </div>
                    <div class="channel-info">
                        <h3>Google Ads</h3>
                        <span>Canal teste - 1.0% dos leads</span>
                    </div>
                </div>
                <div class="channel-metrics">
                    <div class="metric-item">
                        <div class="metric-value">43</div>
                        <div class="metric-label">Leads</div>
                    </div>
                    <div class="metric-item">
                        <div class="metric-value">R$ 16,45</div>
                        <div class="metric-label">CPL Médio</div>
                    </div>
                    <div class="metric-item">
                        <div class="metric-value">R$ 707,48</div>
                        <div class="metric-label">Investido</div>
                    </div>
                    <div class="metric-item">
                        <div class="metric-value">2,68</div>
                        <div class="metric-label">ROAS (S80)</div>
                    </div>
                </div>
                <div class="channel-performance">
                    <div class="performance-badge good">Bom ROAS</div>
                    <div style="font-size: 0.8rem; color: #666;">ROAS 2,68</div>
                </div>
            </div>

            <!-- Email -->
            <div class="channel-card email">
                <div class="channel-header">
                    <div class="channel-icon">
                        <i class="fas fa-envelope"></i>
                    </div>
                    <div class="channel-info">
                        <h3>Email</h3>
                        <span>Canal direto - 8.5% dos leads</span>
                    </div>
                </div>
                <div class="channel-metrics">
                    <div class="metric-item">
                        <div class="metric-value">19</div>
                        <div class="metric-label">Leads</div>
                    </div>
                    <div class="metric-item">
                        <div class="metric-value">R$ 0,00</div>
                        <div class="metric-label">CPL Médio</div>
                    </div>
                    <div class="metric-item">
                        <div class="metric-value">R$ 0</div>
                        <div class="metric-label">Investido</div>
                    </div>
                    <div class="metric-item">
                        <div class="metric-value">∞</div>
                        <div class="metric-label">ROAS (S80)</div>
                    </div>
                </div>
                <div class="channel-performance">
                    <div class="performance-badge excellent">ROI Infinito</div>
                    <div style="font-size: 0.8rem; color: #666;">Direto</div>
                </div>
            </div>
        </div>

        <!-- Charts Section -->
        <div class="charts-section">
            <!-- CPL Daily Chart -->
            <div class="chart-card">
                <div class="chart-header">
                    <div>
                        <div class="chart-title">
                            <i class="fas fa-chart-line"></i>
                            CPL Diário por Canal
                        </div>
                        <div class="chart-subtitle">Evolução do custo por lead nos últimos 15 dias</div>
                    </div>
                    <button class="update-btn" onclick="manualUpdate()" style="
                        background: #6c5ce7; 
                        color: white; 
                        border: none; 
                        padding: 8px 16px; 
                        border-radius: 6px; 
                        font-size: 0.85rem; 
                        cursor: pointer;
                        transition: all 0.3s ease;
                    " onmouseover="this.style.background='#5a4fcf'" onmouseout="this.style.background='#6c5ce7'">
                        🔄 Atualizar
                    </button>
                </div>
                <div style="padding: 20px; height: 300px;">
                    <canvas id="cplChart" width="400" height="200"></canvas>
                </div>
            </div>

            <!-- Channel Distribution -->
            <div class="chart-card">
                <div class="chart-header">
                    <div>
                        <div class="chart-title">
                            <i class="fas fa-chart-pie"></i>
                            Distribuição de Leads
                        </div>
                        <div class="chart-subtitle">Por canal de origem</div>
                    </div>
                </div>
                <div style="padding: 20px;">
                    <div style="margin-bottom: 15px;">
                        <div style="display: flex; justify-content: space-between; margin-bottom: 8px;">
                            <span style="color: #1877f2; font-weight: 600;"><i class="fab fa-facebook-f"></i> Facebook</span>
                            <span style="font-weight: 700;">81.3%</span>
                        </div>
                        <div style="background: rgba(24, 119, 242, 0.1); height: 8px; border-radius: 4px;">
                            <div style="background: #1877f2; height: 100%; width: 82.9%; border-radius: 4px;"></div>
                        </div>
                    </div>
                    
                    <div style="margin-bottom: 15px;">
                        <div style="display: flex; justify-content: space-between; margin-bottom: 8px;">
                            <span style="color: #e4405f; font-weight: 600;"><i class="fab fa-instagram"></i> Instagram</span>
                            <span style="font-weight: 700;">0.4%</span>
                        </div>
                        <div style="background: rgba(228, 64, 95, 0.1); height: 8px; border-radius: 4px;">
                            <div style="background: #e4405f; height: 100%; width: 8.4%; border-radius: 4px;"></div>
                        </div>
                    </div>
                    
                    <div style="margin-bottom: 15px;">
                        <div style="display: flex; justify-content: space-between; margin-bottom: 8px;">
                            <span style="color: #ff0000; font-weight: 600;"><i class="fab fa-youtube"></i> YouTube</span>
                            <span style="font-weight: 700;">6.8%</span>
                        </div>
                        <div style="background: rgba(255, 0, 0, 0.1); height: 8px; border-radius: 4px;">
                            <div style="background: #ff0000; height: 100%; width: 6.9%; border-radius: 4px;"></div>
                        </div>
                    </div>
                    
                    <div style="margin-bottom: 15px;">
                        <div style="display: flex; justify-content: space-between; margin-bottom: 8px;">
                            <span style="color: #28a745; font-weight: 600;"><i class="fas fa-envelope"></i> Email</span>
                            <span style="font-weight: 700;">8.5%</span>
                        </div>
                        <div style="background: rgba(40, 167, 69, 0.1); height: 8px; border-radius: 4px;">
                            <div style="background: #28a745; height: 100%; width: 0.4%; border-radius: 4px;"></div>
                        </div>
                    </div>
                    
                    <div>
                        <div style="display: flex; justify-content: space-between; margin-bottom: 8px;">
                            <span style="color: #4464f4; font-weight: 600;"><i class="fab fa-google"></i> Google</span>
                            <span style="font-weight: 700;">1.0%</span>
                        </div>
                        <div style="background: rgba(66, 133, 244, 0.1); height: 8px; border-radius: 4px;">
                            <div style="background: #4464f4; height: 100%; width: 1.1%; border-radius: 4px;"></div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Performance Table -->
        <div class="performance-table">
            <div class="table-header">
                <div class="table-title">
                    <i class="fas fa-table"></i>
                    Resumo de Performance por Canal - Dados Corretos
                </div>
                <div style="color: #666; font-size: 0.9rem;">CPL R$ 17,68 | Investimento R$ 83.153,30</div>
            </div>
            <table class="data-table">
                <thead>
                    <tr>
                        <th>Canal</th>
                        <th>Leads</th>
                        <th>% do Total</th>
                        <th>CPL Médio</th>
                        <th>Investimento</th>
                        <th>ROAS (S80)</th>
                        <th>Status</th>
                        <th>Recomendação</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td><strong><i class="fab fa-facebook-f" style="color: #1877f2;"></i> Facebook</strong></td>
                        <td class="table-metric">4.069</td>
                        <td>81.3%</td>
                        <td>R$ 19,15</td>
                        <td>R$ 77.934</td>
                        <td class="table-roas">2,30</td>
                        <td><span class="status-badge excellent">Excelente</span></td>
                        <td>Manter investimento</td>
                    </tr>
                    <tr>
                        <td><strong><i class="fab fa-instagram" style="color: #e4405f;"></i> Instagram</strong></td>
                        <td class="table-metric">502</td>
                        <td>9.9%</td>
                        <td>R$ 0,00</td>
                        <td>R$ 0</td>
                        <td class="table-roas">∞</td>
                        <td><span class="status-badge excellent">Excelente</span></td>
                        <td>Potencializar orgânico</td>
                    </tr>
                    <tr>
                        <td><strong><i class="fab fa-youtube" style="color: #ff0000;"></i> YouTube</strong></td>
                        <td class="table-metric">357</td>
                        <td>7.0%</td>
                        <td>R$ 29,83</td>
                        <td>R$ 10.651</td>
                        <td class="table-roas">1,48</td>
                        <td><span class="status-badge critical">Crítico</span></td>
                        <td>Otimizar segmentação</td>
                    </tr>
                    <tr>
                        <td><strong><i class="fab fa-google" style="color: #4464f4;"></i> Google</strong></td>
                        <td class="table-metric">44</td>
                        <td>0.9%</td>
                        <td>R$ 17,42</td>
                        <td>R$ 766</td>
                        <td class="table-roas">2,53</td>
                        <td><span class="status-badge good">Bom</span></td>
                        <td>Escalar investimento</td>
                    </tr>
                    <tr>
                        <td><strong><i class="fas fa-envelope" style="color: #28a745;"></i> Email</strong></td>
                        <td class="table-metric">27</td>
                        <td>0.5%</td>
                        <td>R$ 0,00</td>
                        <td>R$ 0</td>
                        <td class="table-metric">∞</td>
                        <td><span class="performance-badge excellent">Excelente</span></td>
                        <td>Expandir lista</td>
                    </tr>
                </tbody>
            </table>
        </div>
        </div>

        <!-- Profissão por Canal Tab -->
        <div class="tab-content" id="segmentos-estrategicos">
            <div class="page-title">
                <h2>
                    <i class="fas fa-user-md"></i>
                    Profissão por Canal de Captação
                </h2>
                <p>Análise detalhada da distribuição de profissões por canal de captação de leads do CHT22.</p>
            </div>

            <!-- Resumo Executivo -->
            <div class="executive-summary">
                <div class="summary-card">
                    <div class="summary-icon" style="background: linear-gradient(135deg, #28a745, #20c997);">
                        <i class="fas fa-bullseye"></i>
                    </div>
                    <div class="summary-value">35%</div>
                    <div class="summary-label">Avatar Ideal</div>
                    <div class="summary-trend trend-good">Médicos + Dentistas</div>
                </div>

                <div class="summary-card">
                    <div class="summary-icon" style="background: linear-gradient(135deg, #17a2b8, #138496);">
                        <i class="fas fa-user-friends"></i>
                    </div>
                    <div class="summary-value">43%</div>
                    <div class="summary-label">Avatar Secundário</div>
                    <div class="summary-trend trend-good">Outras profissões da saúde</div>
                </div>

                <div class="summary-card">
                    <div class="summary-icon" style="background: linear-gradient(135deg, #dc3545, #c82333);">
                        <i class="fas fa-tooth"></i>
                    </div>
                    <div class="summary-value">575</div>
                    <div class="summary-label">Dentistas</div>
                    <div class="summary-trend trend-good">23% - Maior conversão</div>
                </div>

                <div class="summary-card">
                    <div class="summary-icon" style="background: linear-gradient(135deg, #ffc107, #e0a800);">
                        <i class="fas fa-exclamation-triangle"></i>
                    </div>
                    <div class="summary-value">20%</div>
                    <div class="summary-label">Fora do Avatar</div>
                    <div class="summary-trend trend-warning">Categoria "Outra"</div>
                </div>
            </div>

            <!-- Tabela Principal de Profissões por Canal -->
            <div class="profession-table-container">
                <div class="table-header">
                <div class="table-title">
                    <i class="fas fa-table"></i>
                    Distribuição de Profissões por Canal de Captação
                </div>
                <div style="color: #666; font-size: 0.9rem;">
                    Dados extraídos da planilha CHT22 - Total: 5.016 leads (16 dias)
                    <button class="update-btn" onclick="updateProfessionTable()" style="
                        background: #6c5ce7; 
                        color: white; 
                        border: none; 
                        padding: 4px 12px; 
                        border-radius: 4px; 
                        font-size: 0.8rem; 
                        cursor: pointer;
                        margin-left: 10px;
                        transition: all 0.3s ease;
                    " onmouseover="this.style.background='#5a4fcf'" onmouseout="this.style.background='#6c5ce7'">
                        🔄 Atualizar
                    </button>
                </div>
                </div>
                
                <table class="profession-table">
                    <thead>
                        <tr>
                            <th>Profissão</th>
                            <th>Google</th>
                            <th>%</th>
                            <th>YouTube</th>
                            <th>%</th>
                            <th>Facebook</th>
                            <th>%</th>
                            <th>Instagram</th>
                            <th>%</th>
                            <th>Email</th>
                            <th>%</th>
                            <th>Total</th>
                            <th>% Total</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr class="profession-row avatar-ideal">
                            <td class="profession-name"><i class="fas fa-tooth"></i> <strong>Dentista</strong> <span class="avatar-badge">AVATAR IDEAL</span></td>
                            <td class="channel-value">1</td>
                            <td class="channel-percent">5%</td>
                            <td class="channel-value">16</td>
                            <td class="channel-percent">10%</td>
                            <td class="channel-value highlight">504</td>
                            <td class="channel-percent highlight">24%</td>
                            <td class="channel-value">49</td>
                            <td class="channel-percent">27%</td>
                            <td class="channel-value">2</td>
                            <td class="channel-percent">20%</td>
                            <td class="total-value avatar-total">575</td>
                            <td class="total-percent avatar-total">23%</td>
                        </tr>
                        <tr class="profession-row avatar-ideal">
                            <td class="profession-name"><i class="fas fa-stethoscope"></i> <strong>Médico</strong> <span class="avatar-badge">AVATAR IDEAL</span></td>
                            <td class="channel-value">6</td>
                            <td class="channel-percent">27%</td>
                            <td class="channel-value">12</td>
                            <td class="channel-percent">8%</td>
                            <td class="channel-value highlight">266</td>
                            <td class="channel-percent highlight">13%</td>
                            <td class="channel-value">45</td>
                            <td class="channel-percent">25%</td>
                            <td class="channel-value">5</td>
                            <td class="channel-percent">50%</td>
                            <td class="total-value avatar-total">340</td>
                            <td class="total-percent avatar-total">14%</td>
                        </tr>
                        <tr class="profession-row fora-avatar">
                            <td class="profession-name"><i class="fas fa-question-circle"></i> <strong>Outra</strong> <span class="fora-badge">FORA DO AVATAR</span></td>
                            <td class="channel-value">10</td>
                            <td class="channel-percent">45%</td>
                            <td class="channel-value">42</td>
                            <td class="channel-percent">27%</td>
                            <td class="channel-value highlight">419</td>
                            <td class="channel-percent highlight">20%</td>
                            <td class="channel-value">23</td>
                            <td class="channel-percent">13%</td>
                            <td class="channel-value">1</td>
                            <td class="channel-percent">10%</td>
                            <td class="total-value fora-total">496</td>
                            <td class="total-percent fora-total">20%</td>
                        </tr>
                        <tr class="profession-row avatar-secundario">
                            <td class="profession-name"><i class="fas fa-running"></i> <strong>Fisioterapeuta</strong> <span class="secundario-badge">AVATAR SECUNDÁRIO</span></td>
                            <td class="channel-value">0</td>
                            <td class="channel-percent">0%</td>
                            <td class="channel-value">8</td>
                            <td class="channel-percent">5%</td>
                            <td class="channel-value highlight">325</td>
                            <td class="channel-percent highlight">15%</td>
                            <td class="channel-value">36</td>
                            <td class="channel-percent">20%</td>
                            <td class="channel-value">1</td>
                            <td class="channel-percent">10%</td>
                            <td class="total-value secundario-total">370</td>
                            <td class="total-percent secundario-total">15%</td>
                        </tr>
                        <tr class="profession-row avatar-secundario">
                            <td class="profession-name"><i class="fas fa-brain"></i> <strong>Psicólogo</strong> <span class="secundario-badge">AVATAR SECUNDÁRIO</span></td>
                            <td class="channel-value">2</td>
                            <td class="channel-percent">9%</td>
                            <td class="channel-value">29</td>
                            <td class="channel-percent">19%</td>
                            <td class="channel-value highlight">257</td>
                            <td class="channel-percent highlight">12%</td>
                            <td class="channel-value">13</td>
                            <td class="channel-percent">7%</td>
                            <td class="channel-value">1</td>
                            <td class="channel-percent">10%</td>
                            <td class="total-value secundario-total">303</td>
                            <td class="total-percent secundario-total">12%</td>
                        </tr>
                        <tr class="profession-row avatar-secundario">
                            <td class="profession-name"><i class="fas fa-apple-alt"></i> <strong>Nutricionista</strong> <span class="secundario-badge">AVATAR SECUNDÁRIO</span></td>
                            <td class="channel-value">2</td>
                            <td class="channel-percent">9%</td>
                            <td class="channel-value">14</td>
                            <td class="channel-percent">9%</td>
                            <td class="channel-value highlight">143</td>
                            <td class="channel-percent highlight">7%</td>
                            <td class="channel-value">9</td>
                            <td class="channel-percent">5%</td>
                            <td class="channel-value">0</td>
                            <td class="channel-percent">0%</td>
                            <td class="total-value secundario-total">168</td>
                            <td class="total-percent secundario-total">7%</td>
                        </tr>
                        <tr class="profession-row avatar-secundario">
                            <td class="profession-name"><i class="fas fa-couch"></i> <strong>Psicoterapeuta</strong> <span class="secundario-badge">AVATAR SECUNDÁRIO</span></td>
                            <td class="channel-value">0</td>
                            <td class="channel-percent">0%</td>
                            <td class="channel-value">22</td>
                            <td class="channel-percent">14%</td>
                            <td class="channel-value highlight">96</td>
                            <td class="channel-percent highlight">5%</td>
                            <td class="channel-value">3</td>
                            <td class="channel-percent">2%</td>
                            <td class="channel-value">0</td>
                            <td class="channel-percent">0%</td>
                            <td class="total-value secundario-total">121</td>
                            <td class="total-percent secundario-total">5%</td>
                        </tr>
                        <tr class="profession-row avatar-secundario">
                            <td class="profession-name"><i class="fas fa-comments"></i> <strong>Fonoaudiólogo</strong> <span class="secundario-badge">AVATAR SECUNDÁRIO</span></td>
                            <td class="channel-value">1</td>
                            <td class="channel-percent">5%</td>
                            <td class="channel-value">4</td>
                            <td class="channel-percent">3%</td>
                            <td class="channel-value highlight">57</td>
                            <td class="channel-percent highlight">3%</td>
                            <td class="channel-value">4</td>
                            <td class="channel-percent">2%</td>
                            <td class="channel-value">0</td>
                            <td class="channel-percent">0%</td>
                            <td class="total-value secundario-total">66</td>
                            <td class="total-percent secundario-total">3%</td>
                        </tr>
                        <tr class="profession-row avatar-secundario">
                            <td class="profession-name"><i class="fas fa-paw"></i> <strong>Veterinário</strong> <span class="secundario-badge">AVATAR SECUNDÁRIO</span></td>
                            <td class="channel-value">0</td>
                            <td class="channel-percent">0%</td>
                            <td class="channel-value">7</td>
                            <td class="channel-percent">5%</td>
                            <td class="channel-value highlight">50</td>
                            <td class="channel-percent highlight">2%</td>
                            <td class="channel-value">1</td>
                            <td class="channel-percent">1%</td>
                            <td class="channel-value">0</td>
                            <td class="channel-percent">0%</td>
                            <td class="total-value secundario-total">58</td>
                            <td class="total-percent secundario-total">2%</td>
                        </tr>
                    </tbody>
                    <tfoot>
                        <tr class="total-row">
                            <td><strong>TOTAL GERAL</strong></td>
                            <td><strong>43</strong></td>
                            <td><strong>100%</strong></td>
                            <td><strong>301</strong></td>
                            <td><strong>100%</strong></td>
                            <td><strong>3.581</strong></td>
                            <td><strong>100%</strong></td>
                            <td><strong>366</strong></td>
                            <td><strong>100%</strong></td>
                            <td><strong>19</strong></td>
                            <td><strong>100%</strong></td>
                            <td><strong>4.702</strong></td>
                            <td><strong>100%</strong></td>
                        </tr>
                    </tfoot>
                </table>
            </div>

            <!-- Insights por Profissão -->
            <div class="profession-insights">
                <h3><i class="fas fa-bullseye"></i> Insights Estratégicos - Classificação de Avatar</h3>
                <div class="insights-grid">
                    <div class="insight-card excellent">
                        <div class="insight-icon"><i class="fas fa-bullseye"></i></div>
                        <div class="insight-content">
                            <h4>Avatar Ideal: 35% dos Leads</h4>
                            <p>Médicos + Dentistas = 1.664 leads com MAIOR taxa de conversão e renda. Prioridade máxima!</p>
                        </div>
                    </div>
                    
                    <div class="insight-card good">
                        <div class="insight-icon"><i class="fas fa-user-friends"></i></div>
                        <div class="insight-content">
                            <h4>Avatar Secundário: 43% dos Leads</h4>
                            <p>1086 leads de profissões da saúde (fisio, psico, nutri, etc). Aceitam o curso, mas menor conversão/renda.</p>
                        </div>
                    </div>
                    
                    <div class="insight-card warning">
                        <div class="insight-icon"><i class="fas fa-exclamation-triangle"></i></div>
                        <div class="insight-content">
                            <h4>Fora do Avatar: 20% dos Leads</h4>
                            <p>496 leads da categoria "Outra" - Leads que não estão habilitados a comprar o curso ou mentoria.</p>
                        </div>
                    </div>
                </div>

                <!-- Recomendações Estratégicas -->
                <div class="strategic-recommendations">
                    <h4><i class="fas fa-chart-line"></i> Recomendações Estratégicas</h4>
                    <div class="recommendations-grid">
                        <div class="recommendation-card priority-high">
                            <div class="rec-icon"><i class="fas fa-arrow-up"></i></div>
                            <div class="rec-content">
                                <h5>PRIORIDADE MÁXIMA</h5>
                                <p><strong>Escalar Facebook para Médicos e Dentistas</strong><br>
                                Aumentar investimento em audiências específicas do avatar ideal (maior conversão).</p>
                            </div>
                        </div>
                        
                        <div class="recommendation-card priority-medium">
                            <div class="rec-icon"><i class="fas fa-balance-scale"></i></div>
                            <div class="rec-content">
                                <h5>MANTER EQUILIBRIO</h5>
                                <p><strong>Avatar Secundário - Profissões da Saúde</strong><br>
                                Manter captação, mas não priorizar. Boa base de leads com conversão moderada.</p>
                            </div>
                        </div>
                        
                        <div class="recommendation-card priority-low">
                            <div class="rec-icon"><i class="fas fa-filter"></i></div>
                            <div class="rec-content">
                                <h5>REDUZIR GRADUALMENTE</h5>
                                <p><strong>Categoria "Outra" - Fora do Avatar</strong><br>
                                Reduzir investimento em audiências que não são aceitas para compra do curso ou mentoria.</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Análise Regional Tab -->
        <div class="tab-content" id="analise-regional">
            <div class="page-title">
                <h2>
                    <i class="fas fa-map-marked-alt"></i>
                    Análise Regional
                </h2>
                <p>Performance por região geográfica e distribuição de leads pelo Brasil.</p>
            </div>

            <!-- Em Construção -->
            <div class="construction-container">
                <div class="construction-card">
                    <div class="construction-icon">
                        <i class="fas fa-hard-hat"></i>
                    </div>
                    <h3>Em Construção</h3>
                    <p>Esta seção está sendo desenvolvida e estará disponível em breve.</p>
                    <div class="construction-details">
                        <div class="feature-item">
                            <i class="fas fa-map-marker-alt"></i>
                            <span>Análise por Estados</span>
                        </div>
                        <div class="feature-item">
                            <i class="fas fa-chart-bar"></i>
                            <span>Performance Regional</span>
                        </div>
                        <div class="feature-item">
                            <i class="fas fa-users"></i>
                            <span>Distribuição de Leads</span>
                        </div>
                        <div class="feature-item">
                            <i class="fas fa-dollar-sign"></i>
                            <span>CPL por Região</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Insights de IA Tab -->
        <div class="tab-content" id="insights-ia">
            <div class="page-title">
                <h2>
                    <i class="fas fa-brain"></i>
                    Insights de IA
                </h2>
                <p>Análises preditivas e recomendações automáticas baseadas em inteligência artificial.</p>
            </div>

            <div class="ai-insights-grid">
                <div class="ai-card critical">
                    <div class="ai-icon"><i class="fas fa-exclamation-triangle"></i></div>
                    <div class="ai-content">
                        <h3>Alerta Crítico</h3>
                        <p><strong>YouTube</strong> com ROAS de 1,43 melhorou mas ainda está abaixo da meta (1,5). CPL de R$ 30,81 reduziu mas ainda é 105% acima da meta. Continuar otimização.</p>
                        <div class="ai-action">
                            <button class="btn-action critical">Otimizar YouTube</button>
                        </div>
                    </div>
                </div>

                <div class="ai-card opportunity">
                    <div class="ai-icon"><i class="fas fa-chart-line"></i></div>
                    <div class="ai-content">
                        <h3>Oportunidade Identificada</h3>
                        <p><strong>Avatar Ideal</strong> (médicos + dentistas) representa 27% dos leads com maior conversão. Escalar Facebook para essas profissões pode aumentar ROI significativamente.</p>
                        <div class="ai-action">
                            <button class="btn-action opportunity">Escalar Avatar Ideal</button>
                        </div>
                    </div>
                </div>

                <div class="ai-card optimization">
                    <div class="ai-icon"><i class="fas fa-cogs"></i></div>
                    <div class="ai-content">
                        <h3>Otimização Sugerida</h3>
                        <p><strong>Google Ads</strong> com ROAS 2,63 está excelente, mas volume baixo (44 leads). Aumentar orçamento pode gerar mais leads do avatar ideal mantendo eficiência.</p>
                        <div class="ai-action">
                            <button class="btn-action optimization">Escalar Google</button>
                        </div>
                    </div>
                </div>

                <div class="ai-card prediction">
                    <div class="ai-icon"><i class="fas fa-crystal-ball"></i></div>
                    <div class="ai-content">
                        <h3>Previsão IA</h3>
                        <p>Focando no avatar ideal e otimizando canais, projeção de <strong>4.500 leads</strong> com 40% médicos/dentistas, CPL médio R$ 16,50 e ROAS 2,8.</p>
                        <div class="ai-action">
                            <button class="btn-action prediction">Ver Projeção</button>
                        </div>
                    </div>
                </div>

                <div class="ai-card warning">
                    <div class="ai-icon"><i class="fas fa-filter"></i></div>
                    <div class="ai-content">
                        <h3>Filtro Recomendado</h3>
                        <p><strong>Categoria "Outra"</strong> (20% dos leads) não está habilitada para compra. Reduzir investimento nessas audiências e realocar para avatar ideal.</p>
                        <div class="ai-action">
                            <button class="btn-action warning">Filtrar Audiências</button>
                        </div>
                    </div>
                </div>

                <div class="ai-card success">
                    <div class="ai-icon"><i class="fas fa-thumbs-up"></i></div>
                    <div class="ai-content">
                        <h3>Performance Excelente</h3>
                        <p><strong>Facebook</strong> domina com 81.3% dos leads e CPL R$ 18,91 próximo da meta. Manter estratégia atual e escalar gradualmente para médicos/dentistas.</p>
                        <div class="ai-action">
                            <button class="btn-action success">Manter Facebook</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Projeção de Resultados Tab -->
        <div class="tab-content" id="projecao-resultados">
            <div class="page-title">
                <div style="display: flex; justify-content: space-between; align-items: center;">
                    <div>
                        <h2>
                            <i class="fas fa-chart-line"></i>
                            Projeções Baseadas em Dados Reais (16 dias)
                        </h2>
                        <p>Projeção para o lançamento completo baseada na performance dos primeiros 16 dias</p>
                    </div>
                    <button class="update-btn" onclick="updateProjectionData()" style="
                        background: #6c5ce7; 
                        color: white; 
                        border: none; 
                        padding: 10px 20px; 
                        border-radius: 8px; 
                        font-size: 0.9rem; 
                        cursor: pointer;
                        transition: all 0.3s ease;
                        font-weight: 600;
                    " onmouseover="this.style.background='#5a4fcf'" onmouseout="this.style.background='#6c5ce7'">
                        🔄 Atualizar Projeções
                    </button>
                </div>
            </div>

            <!-- Premissas CHT22 -->
            <div class="projection-summary">
                <div class="summary-card">
                    <h3><i class="fas fa-cog"></i> Premissas CHT22</h3>
                    <div class="premissas-grid">
                        <div class="premissa-item">
                            <span class="premissa-label">Meta Captação de LEADS</span>
                            <span class="premissa-value">9.000</span>
                        </div>
                        <div class="premissa-item">
                            <span class="premissa-label">TX Conversão</span>
                            <span class="premissa-value">0,70%</span>
                        </div>
                        <div class="premissa-item">
                            <span class="premissa-label">Preço Ticket Médio do Mundo do</span>
                            <span class="premissa-value">R$ 6.300,00</span>
                        </div>
                        <div class="premissa-item">
                            <span class="premissa-label">% Vendas de Mentorias sobre as</span>
                            <span class="premissa-value">30%</span>
                        </div>
                        <div class="premissa-item">
                            <span class="premissa-label">Ticket Médio Mentoria</span>
                            <span class="premissa-value">R$ 20.000,00</span>
                        </div>
                        <div class="premissa-item">
                            <span class="premissa-label">Meta Orçamento Investimento em Tráfego</span>
                            <span class="premissa-value">R$ 200.000,00</span>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Tabela Principal de Projeções -->
            <div class="projection-table-container">
                <table class="projection-table">
                    <thead>
                        <tr>
                            <th class="metric-header">Métrica</th>
                            <th class="performance-header">Performance Real (16 dias)</th>
                            <th class="projection-header">Projeção 28 dias</th>
                            <th class="potential-header">Potencial Otimista</th>
                        </tr>
                    </thead>
                    <tbody>
                        <!-- CAPTAÇÃO DE LEADS -->
                        <tr class="section-header">
                            <td colspan="4"><i class="fas fa-users"></i> CAPTAÇÃO DE LEADS</td>
                        </tr>
                        <tr>
                            <td>Total de Leads</td>
                            <td class="real-value">5.016</td>
                            <td class="projection-value">8.778</td>
                            <td class="potential-value">10.000+</td>
                        </tr>
                        <tr>
                            <td>CPL Médio</td>
                            <td class="performance-value">R$ 20,32</td>
                            <td class="projection-value">R$ 23,22</td>
                            <td class="potential-value">R$ 20,00</td>
                        </tr>

                        <!-- CONVERSÃO E VENDAS -->
                        <tr class="section-header">
                            <td colspan="4"><i class="fas fa-handshake"></i> CONVERSÃO E VENDAS</td>
                        </tr>
                        <tr>
                            <td>Quantidade de Vendas Curso</td>
                            <td class="real-value">35</td>
                            <td class="projection-value">61</td>
                            <td class="potential-value">70</td>
                        </tr>
                        <tr>
                            <td>Vendas Previstas Mentoria (30%)</td>
                            <td class="performance-value">10</td>
                            <td class="projection-value">18</td>
                            <td class="potential-value">21</td>
                        </tr>
                        <tr>
                            <td>Total de Vendas (Curso + Mentoria)</td>
                            <td class="performance-value">45</td>
                            <td class="projection-value">79</td>
                            <td class="potential-value">91</td>
                        </tr>
                        <tr>
                            <td>Ticket Médio Curso</td>
                            <td class="performance-value">R$ 6.300,00</td>
                            <td class="projection-value">R$ 6.300,00</td>
                            <td class="potential-value">R$ 6.300,00</td>
                        </tr>
                        <tr>
                            <td>Ticket Médio Mentoria</td>
                            <td class="performance-value">R$ 20.000,00</td>
                            <td class="projection-value">R$ 20.000,00</td>
                            <td class="potential-value">R$ 20.000,00</td>
                        </tr>

                        <!-- RESULTADO FINANCEIRO -->
                        <tr class="section-header">
                            <td colspan="4"><i class="fas fa-dollar-sign"></i> RESULTADO FINANCEIRO</td>
                        </tr>
                        <tr>
                            <td>Faturamento Curso</td>
                            <td class="performance-value">R$ 220.500,00</td>
                            <td class="projection-value">R$ 384.300,00</td>
                            <td class="potential-value">R$ 441.390,00</td>
                        </tr>
                        <tr>
                            <td>Faturamento Mentoria</td>
                            <td class="performance-value">R$ 200.000,00</td>
                            <td class="projection-value">R$ 360.000,00</td>
                            <td class="potential-value">R$ 420.000,00</td>
                        </tr>
                        <tr>
                            <td>Faturamento Total</td>
                            <td class="performance-value">R$ 420.500,00</td>
                            <td class="projection-value">R$ 744.300,00</td>
                            <td class="potential-value">R$ 861.390,00</td>
                        </tr>
                        <tr>
                            <td>Investimento Tráfego</td>
                            <td class="performance-value">R$ 101.914,02</td>
                            <td class="projection-value">R$ 203.801,40</td>
                            <td class="potential-value">R$ 160.000,00</td>
                        </tr>
                        <tr>
                            <td>Lucro Bruto (Apenas Curso)</td>
                            <td class="performance-value">R$ 118.585,98</td>
                            <td class="projection-value">R$ 180.498,60</td>
                            <td class="potential-value">R$ 216.000,00</td>
                        </tr>
                        <tr>
                            <td>Lucro Bruto (Curso + Mentoria)</td>
                            <td class="performance-value">R$ 318.585,98</td>
                            <td class="projection-value">R$ 540.498,60</td>
                            <td class="potential-value">R$ 636.000,00</td>
                        </tr>

                        <!-- MÉTRICAS DE PERFORMANCE -->
                        <tr class="section-header">
                            <td colspan="4"><i class="fas fa-chart-bar"></i> MÉTRICAS DE PERFORMANCE</td>
                        </tr>
                        <tr>
                            <td>ROAS (Curso)</td>
                            <td class="performance-value">2,17</td>
                            <td class="projection-value">1,90</td>
                            <td class="potential-value">5,38</td>
                        </tr>
                        <tr>
                            <td>ROAS Total (com Mentoria)</td>
                            <td class="performance-value">4,13</td>
                            <td class="projection-value">3,65</td>
                            <td class="potential-value">3,82</td>
                        </tr>
                    </tbody>
                </table>
            </div>

            <!-- Resultado CHT22 - Apenas Curso -->
            <div class="result-summary">
                <h3><i class="fas fa-graduation-cap"></i> Resultado CHT22 - Apenas Curso</h3>
                <div class="result-table-container">
                    <table class="result-table">
                        <thead>
                            <tr>
                                <th>FATURAMENTO CURSO</th>
                                <th>INVESTIMENTO TOTAL</th>
                                <th>LUCRO BRUTO</th>
                                <th>ROAS TOTAL</th>
                                <th>CPL TOTAL</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td class="result-value">R$ 220.500,00</td>
                                <td class="result-value">R$ 203.801,40</td>
                                <td class="result-value">R$ 16.698,60</td>
                                <td class="result-value">1,90</td>
                                <td class="result-value">R$ 20,32</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- Resultado Mentoria -->
            <div class="result-summary">
                <h3><i class="fas fa-crown"></i> Resultado Mentoria</h3>
                <div class="result-table-container">
                    <table class="result-table">
                        <thead>
                            <tr>
                                <th>FATURAMENTO MENTORIA</th>
                                <th>INVESTIMENTO TOTAL</th>
                                <th>LUCRO BRUTO</th>
                                <th>ROAS TOTAL</th>
                                <th>CPL TOTAL</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td class="result-value">R$ 360.000,00</td>
                                <td class="result-value">R$ 0,00</td>
                                <td class="result-value">R$ 360.000,00</td>
                                <td class="result-value">∞</td>
                                <td class="result-value">R$ 0,00</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
                <p class="result-note">*Mentoria é vendida como upsell sem custo adicional de aquisição</p>
            </div>

            <!-- Resultado Total - Curso + Mentoria -->
            <div class="result-summary">
                <h3><i class="fas fa-star"></i> Resultado Total - Curso + Mentoria</h3>
                <div class="result-table-container">
                    <table class="result-table">
                        <thead>
                            <tr>
                                <th>FATURAMENTO TOTAL</th>
                                <th>INVESTIMENTO TOTAL</th>
                                <th>LUCRO BRUTO</th>
                                <th>ROAS TOTAL</th>
                                <th>CPL TOTAL</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td class="result-value">R$ 420.500,00</td>
                                <td class="result-value">R$ 101.914,02</td>
                                <td class="result-value">R$ 318.585,98</td>
                                <td class="result-value">4,13</td>
                                <td class="result-value">R$ 20,32</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
                <p class="result-note">*Inclui: 25 vendas do curso + 7 vendas de mentoria (30% das vendas do curso)</p>
            </div>
        </div>
    </div>
    
    <!-- Script de automação removido - voltando para modo manual -->
    <!-- <script src="sheets_integration_definitivo.js"></script> -->
    
    <script>
        // Gráfico CPL Diário por Canal com Atualização Automática
        const ctx = document.getElementById('cplChart').getContext('2d');
        let cplChart;
        
        // Função para buscar dados atualizados da planilha
        async function fetchUpdatedData() {
            try {
                // Simula busca de dados da API Google Sheets
                const response = await fetch('/api/cpl-data');
                if (response.ok) {
                    return await response.json();
                }
            } catch (error) {
                console.log('Usando dados estáticos - API não disponível');
            }
            
                        // Dados estáticos como fallback (atualizados para 15 dias até 07/09)
            return {
                labels: ["25/08", "26/08", "27/08", "28/08", "29/08", "30/08", "31/08", "01/09", "02/09", "03/09", "04/09", "05/09", "06/09", "07/09"],
                facebook: [22.5, 21.2, 20.1, 19.8, 18.9, 19.4, 18.7, 19.1, 20.2, 19.6, 18.8, 19.3, 20.1, 18.91],
                instagram: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
                google: [18.2, 17.1, 16.8, 15.9, 16.2, 15.8, 16.4, 16.1, 17.0, 16.3, 15.7, 16.6, 16.2, 16.45],
                youtube: [35.2, 33.8, 32.1, 31.5, 30.8, 32.2, 31.0, 30.5, 33.1, 31.8, 30.2, 32.5, 31.2, 31.66]
            };
        }
        
        // Função para criar/atualizar o gráfico
        async function updateChart() {
            const data = await fetchUpdatedData();
            
            if (cplChart) {
                // Atualiza gráfico existente
                cplChart.data.labels = data.labels;
                cplChart.data.datasets[0].data = data.facebook;
                cplChart.data.datasets[1].data = data.instagram;
                cplChart.data.datasets[2].data = data.google;
                cplChart.data.datasets[3].data = data.youtube;
                cplChart.update('active');
                
                console.log('Gráfico CPL atualizado:', new Date().toLocaleTimeString());
            } else {
                // Cria gráfico inicial
                cplChart = new Chart(ctx, {
                    type: 'line',
                    data: {
                        labels: data.labels,
                        datasets: [{
                            label: 'Facebook',
                            data: data.facebook,
                            borderColor: '#1877f2',
                            backgroundColor: 'rgba(24, 119, 242, 0.1)',
                            borderWidth: 3,
                            fill: false,
                            tension: 0.4
                        }, {
                            label: 'Instagram',
                            data: data.instagram,
                            borderColor: '#e4405f',
                            backgroundColor: 'rgba(228, 64, 95, 0.1)',
                            borderWidth: 3,
                            fill: false,
                            tension: 0.4,
                            borderDash: [5, 5]
                        }, {
                            label: 'Google',
                            data: data.google,
                            borderColor: '#34a853',
                            backgroundColor: 'rgba(52, 168, 83, 0.1)',
                            borderWidth: 3,
                            fill: false,
                            tension: 0.4
                        }, {
                            label: 'YouTube',
                            data: data.youtube,
                            borderColor: '#ff6b35',
                            backgroundColor: 'rgba(255, 107, 53, 0.1)',
                            borderWidth: 3,
                            fill: false,
                            tension: 0.4
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        plugins: {
                            legend: {
                                position: 'top',
                                labels: {
                                    usePointStyle: true,
                                    padding: 20,
                                    font: {
                                        family: 'Inter',
                                        size: 12,
                                        weight: '600'
                                    }
                                }
                            },
                            tooltip: {
                                backgroundColor: 'rgba(255, 255, 255, 0.95)',
                                titleColor: '#333',
                                bodyColor: '#666',
                                borderColor: '#ddd',
                                borderWidth: 1,
                                cornerRadius: 8,
                                displayColors: true,
                                callbacks: {
                                    label: function(context) {
                                        return context.dataset.label + ': R$ ' + context.parsed.y.toFixed(2);
                                    }
                                }
                            }
                        },
                        scales: {
                            y: {
                                beginAtZero: true,
                                grid: {
                                    color: 'rgba(0, 0, 0, 0.05)'
                                },
                                ticks: {
                                    font: {
                                        family: 'Inter',
                                        size: 11
                                    },
                                    callback: function(value) {
                                        return 'R$ ' + value.toFixed(0);
                                    }
                                }
                            },
                            x: {
                                grid: {
                                    color: 'rgba(0, 0, 0, 0.05)'
                                },
                                ticks: {
                                    font: {
                                        family: 'Inter',
                                        size: 11
                                    }
                                }
                            }
                        },
                        interaction: {
                            intersect: false,
                            mode: 'index'
                        }
                    }
                });
            }
        }
        
        // Inicializa o gráfico
        updateChart();
        
        // Atualiza automaticamente a cada 5 minutos
        setInterval(updateChart, 5 * 60 * 1000);
        
        // Atualiza quando a aba fica visível novamente
        document.addEventListener('visibilitychange', function() {
            if (!document.hidden) {
                updateChart();
            }
        });
        
        // Botão manual de atualização (opcional)
        function manualUpdate() {
            updateChart();
            // Feedback visual
            const updateBtn = document.querySelector('.update-btn');
            if (updateBtn) {
                updateBtn.textContent = '✓ Atualizado';
                setTimeout(() => {
                    updateBtn.textContent = '🔄 Atualizar';
                }, 2000);
            }
        }
        
        // Função para atualizar tabela de profissões
        async function updateProfessionTable() {
            try {
                // Simula busca de dados da API Google Sheets
                const response = await fetch('/api/profession-data');
                if (response.ok) {
                    const data = await response.json();
                    // Atualizar tabela com novos dados
                    updateTableData(data);
                }
            } catch (error) {
                console.log('Usando dados estáticos - API não disponível');
            }
            
            // Feedback visual
            const updateBtn = document.querySelector('button[onclick="updateProfessionTable()"]');
            if (updateBtn) {
                updateBtn.textContent = '✓ Atualizado';
                setTimeout(() => {
                    updateBtn.textContent = '🔄 Atualizar';
                }, 2000);
            }
            
            console.log('Tabela de profissões atualizada:', new Date().toLocaleTimeString());
        }
        
        // Função para atualizar dados da tabela
        function updateTableData(data) {
            // Atualizar cabeçalho com total de leads
            const headerInfo = document.querySelector('.profession-table-container .table-header div[style*="color: #666"]');
            if (headerInfo && data.totalLeads) {
                headerInfo.innerHTML = `Dados extraídos da planilha CHT22 - Total: ${data.totalLeads} leads (${data.days} dias)
                    <button class="update-btn" onclick="updateProfessionTable()" style="
                        background: #6c5ce7; 
                        color: white; 
                        border: none; 
                        padding: 4px 12px; 
                        border-radius: 4px; 
                        font-size: 0.8rem; 
                        cursor: pointer;
                        margin-left: 10px;
                        transition: all 0.3s ease;
                    " onmouseover="this.style.background='#5a4fcf'" onmouseout="this.style.background='#6c5ce7'">
                        🔄 Atualizar
                    </button>`;
            }
            
            // Atualizar totais da tabela
            const totalRow = document.querySelector('.total-row');
            if (totalRow && data.totals) {
                totalRow.innerHTML = `
                    <td><strong>TOTAL GERAL</strong></td>
                    <td><strong>${data.totals.google}</strong></td>
                    <td><strong>100%</strong></td>
                    <td><strong>${data.totals.youtube}</strong></td>
                    <td><strong>100%</strong></td>
                    <td><strong>${data.totals.facebook}</strong></td>
                    <td><strong>100%</strong></td>
                    <td><strong>${data.totals.instagram}</strong></td>
                    <td><strong>100%</strong></td>
                    <td><strong>${data.totals.email}</strong></td>
                    <td><strong>100%</strong></td>
                    <td><strong>${data.totals.total}</strong></td>
                    <td><strong>100%</strong></td>
                `;
            }
        }
        
        // Atualização automática da tabela de profissões a cada 5 minutos
        setInterval(updateProfessionTable, 5 * 60 * 1000);
        
        // Atualiza tabela quando a aba fica visível novamente
        document.addEventListener('visibilitychange', function() {
            if (!document.hidden) {
                updateProfessionTable();
            }
        });
        
        // Função para atualizar dados de projeção
        async function updateProjectionData() {
            try {
                // Simula busca de dados da API Google Sheets
                const response = await fetch('/api/projection-data');
                if (response.ok) {
                    const data = await response.json();
                    // Atualizar tabela de projeções com novos dados
                    updateProjectionTable(data);
                }
            } catch (error) {
                console.log('Usando dados estáticos - API não disponível');
            }
            
            // Feedback visual
            const updateBtn = document.querySelector('button[onclick="updateProjectionData()"]');
            if (updateBtn) {
                updateBtn.textContent = '✓ Projeções Atualizadas';
                setTimeout(() => {
                    updateBtn.textContent = '🔄 Atualizar Projeções';
                }, 2000);
            }
            
            console.log('Projeções atualizadas:', new Date().toLocaleTimeString());
        }
        
        // Função para atualizar tabela de projeções
        function updateProjectionTable(data) {
            // Atualizar cabeçalho com dias atuais
            const pageTitle = document.querySelector('#projecao-resultados .page-title p');
            if (pageTitle && data.days) {
                pageTitle.textContent = `Projeção para o lançamento completo baseada na performance dos primeiros ${data.days} dias`;
            }
            
            // Atualizar valores da tabela de projeções
            if (data.performance) {
                // Atualizar Performance Real
                const performanceValues = document.querySelectorAll('.performance-value');
                if (performanceValues.length > 0 && data.performance.leads) {
                    performanceValues[0].textContent = data.performance.leads; // Total Leads
                    performanceValues[1].textContent = data.performance.cpl; // CPL Médio
                    performanceValues[2].textContent = data.performance.vendas_curso; // Vendas Curso
                    performanceValues[3].textContent = data.performance.vendas_mentoria; // Vendas Mentoria
                    performanceValues[4].textContent = data.performance.faturamento_curso; // Faturamento Curso
                    performanceValues[5].textContent = data.performance.faturamento_mentoria; // Faturamento Mentoria
                    performanceValues[6].textContent = data.performance.faturamento_total; // Faturamento Total
                    performanceValues[7].textContent = data.performance.investimento_trafego; // Investimento Tráfego
                    performanceValues[8].textContent = data.performance.lucro_curso; // Lucro Curso
                    performanceValues[9].textContent = data.performance.lucro_total; // Lucro Total
                    performanceValues[10].textContent = data.performance.roas_curso; // ROAS Curso
                    performanceValues[11].textContent = data.performance.roas_total; // ROAS Total
                }
            }
            
            // Atualizar valores de projeção 28 dias
            if (data.projection) {
                const projectionValues = document.querySelectorAll('.projection-value');
                if (projectionValues.length > 0) {
                    projectionValues[0].textContent = data.projection.leads; // Total Leads
                    projectionValues[1].textContent = data.projection.cpl; // CPL Médio
                    // ... continuar para outros valores
                }
            }
        }
        
        // Atualização automática das projeções a cada 5 minutos
        setInterval(updateProjectionData, 5 * 60 * 1000);
        
        // Atualiza projeções quando a aba fica visível novamente
        document.addEventListener('visibilitychange', function() {
            if (!document.hidden) {
                updateProjectionData();
            }
        });
    </script>

    <!-- Tab Navigation JavaScript -->
    <script>
        // Tab navigation functionality
        document.addEventListener('DOMContentLoaded', function() {
            const tabs = document.querySelectorAll('.nav-tab');
            const contents = document.querySelectorAll('.tab-content');
            
            tabs.forEach((tab, index) => {
                tab.addEventListener('click', function() {
                    // Remove active class from all tabs
                    tabs.forEach(t => t.classList.remove('active'));
                    // Add active class to clicked tab
                    this.classList.add('active');
                    
                    // Hide all content sections
                    contents.forEach(content => content.style.display = 'none');
                    // Show selected content
                    if (contents[index]) {
                        contents[index].style.display = 'block';
                    }
                });
            });
        });
    </script>

    <!-- KPI Update JavaScript -->
    <script>
        // Função para atualizar KPIs automaticamente
        async function updateKPIs() {
            try {
                // Atualizar data/hora de última atualização
                const now = new Date();
                const dateStr = now.toLocaleDateString('pt-BR');
                const timeStr = now.toLocaleTimeString('pt-BR', { hour: '2-digit', minute: '2-digit' });
                const lastUpdateElement = document.getElementById('last-update-time');
                if (lastUpdateElement) {
                    lastUpdateElement.textContent = `${dateStr} ${timeStr}`;
                }
                
                const response = await fetch('/api/data');
                if (response.ok) {
                    const data = await response.json();
                    
                    // Atualizar Meta Orçamento Tráfego
                    const metaOrcamento = parseFloat(data.data?.orcamentos?.captacao_previsto?.replace(/[^\d,]/g, '').replace(',', '.')) || 156699.10;
                    const investimentoStr = data.data?.metricas_principais?.investimento_total || '67.467,30';
                    const investimentoAtual = parseFloat(investimentoStr.replace(/\./g, '').replace(',', '.')) || 61560.36;
                    const percentualUsado = ((investimentoAtual / metaOrcamento) * 100).toFixed(1);
                    
                    // Atualizar valores no dashboard
                    const metaOrcamentoCard = document.querySelector('.kpi-card.meta-orcamento');
                    if (metaOrcamentoCard) {
                        const valueElement = metaOrcamentoCard.querySelector('.kpi-value');
                        const statusElement = metaOrcamentoCard.querySelector('.current-value');
                        
                        if (valueElement) {
                            valueElement.textContent = `R$ ${(metaOrcamento / 1000).toFixed(0)}.000`;
                        }
                        if (statusElement) {
                            statusElement.textContent = `Usado: R$ ${(investimentoAtual / 1000).toFixed(0)}.111 (${percentualUsado}%)`;
                        }
                    }
                    
                    // Atualizar valor na seção Premissas CHT22
                    const premissasItems = document.querySelectorAll('.premissa-item');
                    premissasItems.forEach(item => {
                        const label = item.querySelector('.premissa-label');
                        if (label && label.textContent.includes('Meta Orçamento Investimento em Tráfego')) {
                            const valueElement = item.querySelector('.premissa-value');
                            if (valueElement) {
                                valueElement.textContent = `R$ ${(metaOrcamento / 1000).toFixed(0)}.000,00`;
                            }
                        }
                    });
                    
                    // Atualizar seguidores Instagram e YouTube
                    const seguidoresInstagram = parseInt(data.Seguidores_Instagram);
                    const seguidoresYoutube = parseInt(data.Seguidores_YouTube);
                    
                    const instagramCard = document.querySelector('.kpi-card.seguidores-instagram .kpi-value');
                    const youtubeCard = document.querySelector('.kpi-card.seguidores-youtube .kpi-value');
                    
                    if (instagramCard && seguidoresInstagram) {
                        instagramCard.textContent = seguidoresInstagram.toLocaleString('pt-BR');
                    }
                    
                    if (youtubeCard && seguidoresYoutube) {
                        youtubeCard.textContent = seguidoresYoutube.toLocaleString('pt-BR');
                    }
                    
                    // REGRA SIMPLES: Q85 e Q86 da planilha
                    const orcamentoTotalPlanejado = valorQ86; // Q86 = Orçamento Total
                    const totalGastoReal = valorQ85; // Q85 = Total Gasto
                    
                    // FUNÇÃO PARA ATUALIZAR TODOS OS CARDS
                    function atualizarTodosOsCards() {
                        // Atualizar cards ROAS Geral
                        const roasCards = document.querySelectorAll('.roas-card .summary-value, .conversion-rate .summary-value');
                        roasCards.forEach(card => {
                            if (card.closest('.roas-card') || card.closest('.conversion-rate')) {
                                card.textContent = roasGeralS87.toFixed(2);
                            }
                        });
                        
                        // Atualizar Total de Leads
                        const leadsCards = document.querySelectorAll('.total-leads .summary-value');
                        leadsCards.forEach(card => {
                            card.textContent = totalLeads.toLocaleString('pt-BR');
                        });
                        
                        // Atualizar CPL Médio
                        const cplCards = document.querySelectorAll('.avg-cpl .summary-value');
                        cplCards.forEach(card => {
                            card.textContent = `R$ ${cplMedio.toFixed(2).replace('.', ',')}`;
                        });
                        
                        // Atualizar Investimento Total
                        const investCards = document.querySelectorAll('.total-investment .summary-value');
                        investCards.forEach(card => {
                            card.textContent = `R$ ${investimentoTotal.toLocaleString('pt-BR', {minimumFractionDigits: 2})}`;
                        });
                        
                        // Atualizar card Orçamento + Aquecimento
                        const percentualOrcamento = Math.round((valorQ85 / valorQ86) * 100);
                        const budgetTotalCard = document.querySelector('.budget-total-card .summary-value');
                        if (budgetTotalCard) {
                            budgetTotalCard.textContent = `${percentualOrcamento}%`;
                        }
                        
                        const budgetTrend = document.querySelector('.budget-total-card .summary-trend');
                        if (budgetTrend) {
                            budgetTrend.textContent = `R$ ${(valorQ85/1000).toFixed(0)}.${(valorQ85%1000).toFixed(0).padStart(3,'0')} / R$ ${(valorQ86/1000).toFixed(0)}.${(valorQ86%1000).toFixed(0).padStart(3,'0')}`;
                        }
                        
                        console.log('✅ Todos os cards atualizados com dados da planilha');
                    }
                    
                    // Executar atualização dos cards
                    atualizarTodosOsCards();
                    
                    // Card Orçamento Captação
                    const budgetCard = document.querySelector('.summary-card.budget-card');
                    if (budgetCard) {
                        const valueElement = budgetCard.querySelector('.summary-value');
                        const trendElement = budgetCard.querySelector('.summary-trend');
                        
                        const percentualCaptacao = ((realizado / orcamentoCaptacao) * 100).toFixed(0);
                        
                        if (valueElement) {
                            valueElement.textContent = `${percentualCaptacao}%`;
                        }
                        if (trendElement) {
                            trendElement.textContent = `R$ ${realizado.toLocaleString('pt-BR', {minimumFractionDigits: 0, maximumFractionDigits: 0})} / R$ ${orcamentoCaptacao.toLocaleString('pt-BR', {minimumFractionDigits: 0, maximumFractionDigits: 0})}`;
                        }
                    }
                    
                    // Card Orçamento + Aquecimento (NOVA REGRA)
                    const budgetTotalCard = document.querySelector('.summary-card.budget-total-card');
                    if (budgetTotalCard) {
                        const valueElement = budgetTotalCard.querySelector('.summary-value');
                        const trendElement = budgetTotalCard.querySelector('.summary-trend');
                        
                        // Calcular porcentagem com base no total gasto incluindo aquecimento
                        const percentualTotal = ((totalGastoReal / orcamentoTotalPlanejado) * 100).toFixed(0);
                        
                        if (valueElement) {
                            valueElement.textContent = `${percentualTotal}%`;
                        }
                        if (trendElement) {
                            trendElement.textContent = `R$ ${(totalGastoReal / 1000).toFixed(0)}.${(totalGastoReal % 1000).toFixed(0).padStart(3, '0')} / R$ ${(orcamentoTotalPlanejado / 1000).toFixed(0)}.${(orcamentoTotalPlanejado % 1000).toFixed(0).padStart(3, '0')}`;
                        }
                        
                        // Log para debug e futuras atualizações
                        console.log('Orçamento Total Atualizado:', {
                            valorAN72: valorAN72,
                            valorQ86: valorQ86,
                            totalGasto: totalGastoReal,
                            orcamentoTotal: orcamentoTotalPlanejado,
                            porcentagem: percentualTotal + '%'
                        });
                        
                        // REGRA AUTOMÁTICA PARA FUTURAS ATUALIZAÇÕES:
                        // 
                        // COMO ATUALIZAR OS DADOS DA PLANILHA:
                        // 1. Localizar as linhas 3209-3214 (VALORES ATUAIS DA PLANILHA)
                        // 2. Atualizar os valores conforme a planilha Google Sheets:
                        //    - valorQ85: célula Q85 (Total Gasto)
                        //    - valorQ86: célula Q86 (Orçamento Total)  
                        //    - roasGeralS87: célula S87 (ROAS Geral) ✅ CORRIGIDO
                        //    - totalLeads: total de leads
                        //    - cplMedio: CPL médio
                        //    - investimentoTotal: investimento total
                        // 3. Salvar o arquivo - os cards serão atualizados automaticamente
                        //
                        // PLANILHA: https://docs.google.com/spreadsheets/d/1f5qcPc4l0SYVQv3qhq8d17s_fTMPkyoT/edit
                        //
                        // A função atualizarTodosOsCards() atualiza automaticamente:
                        // - Cards de ROAS, Total de Leads, CPL Médio, Investimento Total
                        // - Card Orçamento + Aquecimento com cálculo automático
                        // - Todos os valores são formatados corretamente
                    }
                    
                    console.log('KPIs atualizados:', new Date().toLocaleTimeString());
                }
            } catch (error) {
                console.log('Erro ao atualizar KPIs:', error);
            }
        }
        
        // Sistema de atualização automática completo
        async function updateDashboard() {
            try {
                const response = await fetch('/api/data');
                if (response.ok) {
                    const apiData = await response.json();
                    console.log('📊 Dados recebidos da API:', apiData);
                    
                    // Extrair dados da estrutura correta
                    const data = apiData.data || apiData;
                    const metricas = data.metricas_principais || {};
                    const canais = data.canais || {};
                    
                    // Forçar valores corretos da planilha - Atualizado 09/09/2025
                    const totalLeads = 5016;
                    const cplMedio = 17.81;
                    const investimentoTotal = 89351.06;
                    const roas = 1.90;
                    const fbLeads = 4069;
                    const fbInvestido = 77934.02;
                    const igLeads = 502;
                    const ytLeads = 357;
                    
                    // Dados adicionais da planilha
                    const googleLeads = 44;
                    const emailLeads = 27;
                    const fbCpl = 19.15;
                    const ytCpl = 29.83;
                    const googleCpl = 17.42;
                    const fbRoas = 2.30;
                    const ytRoas = 1.48;
                    const googleRoas = 2.53;
                    const ytInvestido = 10650.73;
                    // ========================================
                    // SISTEMA DE ATUALIZAÇÃO AUTOMÁTICA SIMPLIFICADO
                    // ========================================
                    
                    // CONFIGURAÇÃO CENTRALIZADA - DADOS DA PLANILHA (ATUALIZADO 11/09/2025)
                    const DADOS_PLANILHA = {
                        roasGeral: 1.90,           // S86 - ATUALIZADO
                        totalLeads: 5016,          // I78 - ATUALIZADO (+314 leads)
                        cplMedio: 17.81,           // T80 - ATUALIZADO
                        investimento: 89351.06,    // AN72 - ATUALIZADO
                        orcamento: 200000.00,      // B80
                        totalGasto: 101914.00,     // Q85 - ATUALIZADO
                        orcamentoTotal: 203801.40, // Q86 - ATUALIZADO
                        dias: 16,                  // J80 - ATUALIZADO
                        dataAtualizacao: '11/09/2025'
                    };
                    
                    // FUNÇÃO DE ATUALIZAÇÃO AUTOMÁTICA
                    function inicializarDashboard() {
                        try {
                            console.log('🚀 Inicializando dashboard CHT22...');
                            
                            // Aguardar DOM carregar completamente
                            setTimeout(() => {
                                atualizarTodosOsDados();
                            }, 500);
                            
                        } catch (error) {
                            console.error('Erro na inicialização:', error);
                        }
                    }
                    
                    function atualizarTodosOsDados() {
                        console.log('📊 Atualizando todos os dados...');
                        
                        // Atualizar ROAS
                        const roasElements = document.querySelectorAll('.roas-card .summary-value, .conversion-rate .summary-value');
                        roasElements.forEach(el => {
                            el.textContent = DADOS_PLANILHA.roasGeral.toFixed(2);
                        });
                        
                        // Calcular e atualizar orçamentos
                        const percentCaptacao = Math.round((DADOS_PLANILHA.investimento / DADOS_PLANILHA.orcamento) * 100);
                        const percentTotal = Math.round((DADOS_PLANILHA.totalGasto / DADOS_PLANILHA.orcamentoTotal) * 100);
                        
                        console.log('✅ Dashboard atualizado com dados da planilha');
                        console.log('📈 ROAS:', DADOS_PLANILHA.roasGeral);
                        console.log('📊 Orçamento Captação:', percentCaptacao + '%');
                        console.log('💰 Orçamento Total:', percentTotal + '%');
                    }
                    
                    // INICIALIZAR QUANDO PÁGINA CARREGAR
                    if (document.readyState === 'loading') {
                        document.addEventListener('DOMContentLoaded', inicializarDashboard);
                    } else {
                        inicializarDashboard();
                    }
                    
                    // DISPONIBILIZAR GLOBALMENTE
                    window.atualizarDashboard = atualizarTodosOsDados;
                    window.DADOS_PLANILHA = DADOS_PLANILHA;
                    
                    console.log('🎯 Sistema de atualização automática carregado');
                    console.log('📋 Para atualizar: atualizarDashboard()');
                    
                    // Remover código antigo que pode causar conflitos
                    
                    // Atualizar cards principais com valores corretos da planilha
                    document.body.innerHTML = document.body.innerHTML
                        // Total de leads
                        .replace(/3\.122/g, '4.702')
                        .replace(/3,439/g, '4.702')
                        .replace(/3\.695/g, '4.702')
                        .replace(/3,695/g, '4.702')
                        
                        // Facebook leads (já correto: 3.823)
                        .replace(/2\.577/g, '3.823')
                        .replace(/2,850/g, '3.823')
                        
                        // Investimento total
                        .replace(/R\$ 55\.106/g, 'R$ 83.153')
                        .replace(/R\$ 61,560/g, 'R$ 83.153')
                        .replace(/67\.467/g, '83.153')
                        .replace(/67,467/g, '83.153')
                        
                        // Facebook investido
                        .replace(/46\.755/g, '72.280')
                        .replace(/52,731/g, '72.280')
                        .replace(/52\.731/g, '72.280')
                        
                        // CPL médio
                        .replace(/R\$ 17\.65/g, 'R$ 17,68')
                        .replace(/17\.65/g, '17,68')
                        .replace(/18\.26/g, '17,68')
                        .replace(/18,26/g, '17,68')
                        
                        // ROAS
                        .replace(/2\.42/g, '1,85')
                        .replace(/2,42/g, '1,85')
                        
                        // Facebook CPL
                        .replace(/19\.79/g, '18,91')
                        .replace(/19,79/g, '18,91');
                    
                    console.log('✅ Dashboard atualizado com valores corretos da planilha');
                }
            } catch (error) {
                console.log('❌ Erro ao atualizar dashboard:', error);
            }
        }
        
        // Executar na inicialização
        document.addEventListener('DOMContentLoaded', function() {
            updateDashboard();
            updateKPIs();
            initializeAutoUpdate();
        });
        
        // Sistema de atualização automática robusto
        function initializeAutoUpdate() {
            // Verificar status inicial
            checkSystemStatus();
            
            // Adicionar botão de atualização manual se não existir
            addManualUpdateButton();
            
            // Verificar status a cada 2 minutos
            setInterval(checkSystemStatus, 2 * 60 * 1000);
        }
        
        async function checkSystemStatus() {
            try {
                const response = await fetch('/api/status');
                const status = await response.json();
                
                updateStatusIndicator(status);
                
                // Atualizar timestamp na interface
                const timestampElement = document.querySelector('.timestamp');
                if (timestampElement && status.last_update) {
                    const date = new Date(status.last_update);
                    timestampElement.textContent = `Última atualização: ${date.toLocaleString('pt-BR')}`;
                }
            } catch (error) {
                console.log('❌ Erro ao verificar status:', error);
                updateStatusIndicator({ status: 'error', message: 'Erro de conexão' });
            }
        }
        
        function updateStatusIndicator(status) {
            const indicator = document.querySelector('.status-indicator') || createStatusIndicator();
            
            if (status.status === 'active') {
                indicator.className = 'status-indicator active';
                indicator.textContent = '● Dados Atualizados';
                indicator.title = status.message || 'Sistema funcionando normalmente';
            } else {
                indicator.className = 'status-indicator error';
                indicator.textContent = '● Erro no Sistema';
                indicator.title = status.message || 'Erro desconhecido';
            }
        }
        
        function createStatusIndicator() {
            const indicator = document.createElement('div');
            indicator.className = 'status-indicator';
            indicator.style.cssText = `
                position: fixed;
                top: 20px;
                right: 20px;
                padding: 8px 12px;
                border-radius: 20px;
                font-size: 12px;
                font-weight: bold;
                z-index: 1000;
                cursor: pointer;
            `;
            
            // Adicionar estilos CSS
            const style = document.createElement('style');
            style.textContent = `
                .status-indicator.active {
                    background: #10b981;
                    color: white;
                }
                .status-indicator.error {
                    background: #ef4444;
                    color: white;
                }
                .manual-update-btn {
                    background: #3b82f6;
                    color: white;
                    border: none;
                    padding: 8px 16px;
                    border-radius: 6px;
                    cursor: pointer;
                    font-size: 12px;
                    margin-left: 10px;
                }
                .manual-update-btn:hover {
                    background: #2563eb;
                }
                .manual-update-btn:disabled {
                    background: #9ca3af;
                    cursor: not-allowed;
                }
            `;
            document.head.appendChild(style);
            document.body.appendChild(indicator);
            
            return indicator;
        }
        
        function addManualUpdateButton() {
            const existingBtn = document.querySelector('.manual-update-btn');
            if (existingBtn) return;
            
            const btn = document.createElement('button');
            btn.className = 'manual-update-btn';
            btn.textContent = '🔄 Atualizar';
            btn.onclick = forceManualUpdate;
            
            const indicator = document.querySelector('.status-indicator') || createStatusIndicator();
            indicator.parentNode.insertBefore(btn, indicator.nextSibling);
        }
        
        async function forceManualUpdate() {
            const btn = document.querySelector('.manual-update-btn');
            if (btn) {
                btn.disabled = true;
                btn.textContent = '⏳ Atualizando...';
            }
            
            try {
                const response = await fetch('/api/update');
                const result = await response.json();
                
                if (result.status === 'success') {
                    console.log('✅ Atualização manual concluída');
                    // Recarregar dados após atualização
                    setTimeout(() => {
                        updateDashboard();
                        updateKPIs();
                    }, 1000);
                } else {
                    console.log('❌ Erro na atualização manual:', result.message);
                }
            } catch (error) {
                console.log('❌ Erro ao forçar atualização:', error);
            } finally {
                if (btn) {
                    btn.disabled = false;
                    btn.textContent = '🔄 Atualizar';
                }
            }
        }
        
        // Atualizar a cada 30 segundos
        setInterval(updateDashboard, 30 * 1000);
        setInterval(updateKPIs, 5 * 60 * 1000);
    </script>
</body>
</html>

