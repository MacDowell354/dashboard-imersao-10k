<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dashboard CHT22 - Nanda Mac</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
    <link rel="icon" type="image/x-icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>üìä</text></svg>">
</head>
<body>
    <div class="container">
        <header>
            <div class="header-content">
                <h1>üìä Dashboard CHT22 - Nanda Mac</h1>
                <div class="header-info">
                    <span class="update-time">√öltima atualiza√ß√£o: {{ timestamp }}</span>
                    <span class="campaign-status">Campanha Ativa - {{ dados.dias_campanha }} dias</span>
                </div>
            </div>
        </header>

        <nav class="dashboard-nav">
            <button class="nav-btn {% if aba_ativa == 'visao-geral' %}active{% endif %}" onclick="showTab('visao-geral')">
                üè† Vis√£o Geral
            </button>
            <button class="nav-btn {% if aba_ativa == 'origem-conversao' %}active{% endif %}" onclick="showTab('origem-conversao')">
                üìä Origem e Convers√£o
            </button>
            <button class="nav-btn {% if aba_ativa == 'profissao-canal' %}active{% endif %}" onclick="showTab('profissao-canal')">
                üë• Profiss√£o por Canal
            </button>
            <button class="nav-btn {% if aba_ativa == 'analise-regional' %}active{% endif %}" onclick="showTab('analise-regional')">
                üó∫Ô∏è An√°lise Regional
            </button>
            <button class="nav-btn {% if aba_ativa == 'insights-ia' %}active{% endif %}" onclick="showTab('insights-ia')">
                ü§ñ Insights de IA
            </button>
            <button class="nav-btn {% if aba_ativa == 'projecao-resultados' %}active{% endif %}" onclick="showTab('projecao-resultados')">
                üìà Proje√ß√£o de Resultado
            </button>
        </nav>

        <main class="dashboard-content">
            <div id="visao-geral" class="tab-content {% if aba_ativa == 'visao-geral' %}active{% endif %}">
                {% include 'visao_geral_atualizada.html' %}
            </div>

            <div id="origem-conversao" class="tab-content {% if aba_ativa == 'origem-conversao' %}active{% endif %}">
                {% include 'origem_conversao_atualizada.html' %}
            </div>

            <div id="profissao-canal" class="tab-content {% if aba_ativa == 'profissao-canal' %}active{% endif %}">
                {% include 'profissao_canal_atualizada.html' %}
            </div>

            <div id="analise-regional" class="tab-content {% if aba_ativa == 'analise-regional' %}active{% endif %}">
                {% include 'analise_regional_atualizada.html' %}
            </div>

            <div id="insights-ia" class="tab-content {% if aba_ativa == 'insights-ia' %}active{% endif %}">
                {% include 'insights_ia_atualizada.html' %}
            </div>

            <div id="projecao-resultados" class="tab-content {% if aba_ativa == 'projecao-resultados' %}active{% endif %}">
                {% include 'projecao_resultados_atualizada.html' %}
            </div>
        </main>

        <footer>
            <div class="footer-content">
                <p>¬© 2025 Nanda Mac - Dashboard CHT22 | Dados atualizados em tempo real</p>
                <div class="footer-links">
                    <a href="/api/dados" target="_blank">üìä API Dados</a>
                    <a href="/api/status" target="_blank">üîÑ Status</a>
                </div>
            </div>
        </footer>
    </div>

    <script>
        function showTab(tabName) {
            // Esconder todas as abas
            const tabs = document.querySelectorAll('.tab-content');
            tabs.forEach(tab => tab.classList.remove('active'));
            
            // Remover classe active de todos os bot√µes
            const buttons = document.querySelectorAll('.nav-btn');
            buttons.forEach(btn => btn.classList.remove('active'));
            
            // Mostrar aba selecionada
            document.getElementById(tabName).classList.add('active');
            
            // Adicionar classe active ao bot√£o clicado
            event.target.classList.add('active');
            
            // Atualizar URL sem recarregar a p√°gina
            const newUrl = '/' + tabName.replace('-', '-');
            window.history.pushState({}, '', newUrl);
        }

        // Auto-refresh a cada 5 minutos
        setInterval(() => {
            location.reload();
        }, 300000);

        // Adicionar anima√ß√µes aos cards
        document.addEventListener('DOMContentLoaded', function() {
            const cards = document.querySelectorAll('.metric-card, .insight-card, .channel-card');
            cards.forEach((card, index) => {
                card.style.animationDelay = `${index * 0.1}s`;
                card.classList.add('fade-in');
            });
        });

        // Fun√ß√£o para copiar dados da API
        function copyApiData() {
            fetch('/api/dados')
                .then(response => response.json())
                .then(data => {
                    navigator.clipboard.writeText(JSON.stringify(data, null, 2));
                    alert('Dados copiados para a √°rea de transfer√™ncia!');
                })
                .catch(error => {
                    console.error('Erro ao copiar dados:', error);
                    alert('Erro ao copiar dados');
                });
        }

        // Adicionar tooltips aos elementos
        document.addEventListener('DOMContentLoaded', function() {
            const elements = document.querySelectorAll('[title]');
            elements.forEach(element => {
                element.addEventListener('mouseenter', function() {
                    this.style.cursor = 'help';
                });
            });
        });
    </script>

    <style>
        .fade-in {
            animation: fadeIn 0.6s ease-in-out forwards;
            opacity: 0;
        }

        @keyframes fadeIn {
            to {
                opacity: 1;
                transform: translateY(0);
            }
            from {
                opacity: 0;
                transform: translateY(20px);
            }
        }

        .tab-content {
            display: none;
            animation: slideIn 0.3s ease-in-out;
        }

        .tab-content.active {
            display: block;
        }

        @keyframes slideIn {
            from {
                opacity: 0;
                transform: translateX(-20px);
            }
            to {
                opacity: 1;
                transform: translateX(0);
            }
        }

        .nav-btn {
            transition: all 0.3s ease;
        }

        .nav-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(0,0,0,0.1);
        }

        .metric-card:hover, .insight-card:hover, .channel-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 25px rgba(0,0,0,0.15);
            transition: all 0.3s ease;
        }

        /* Responsividade aprimorada */
        @media (max-width: 768px) {
            .dashboard-nav {
                flex-wrap: wrap;
                gap: 5px;
            }
            
            .nav-btn {
                font-size: 12px;
                padding: 8px 12px;
                flex: 1;
                min-width: 120px;
            }
            
            .metrics-grid {
                grid-template-columns: 1fr;
                gap: 15px;
            }
            
            .insights-grid {
                grid-template-columns: 1fr;
            }
            
            .header-content {
                flex-direction: column;
                text-align: center;
                gap: 10px;
            }
            
            .header-info {
                flex-direction: column;
                gap: 5px;
            }
        }

        /* Melhorias visuais */
        .status-success { color: #48bb78; font-weight: bold; }
        .status-warning { color: #ed8936; font-weight: bold; }
        .status-error { color: #f56565; font-weight: bold; }
        .status-info { color: #4299e1; font-weight: bold; }

        .priority-high { color: #f56565; font-weight: bold; }
        .priority-medium { color: #ed8936; font-weight: bold; }
        .priority-low { color: #48bb78; font-weight: bold; }

        .impact-high { 
            background: #fed7d7; 
            color: #c53030; 
            padding: 4px 8px; 
            border-radius: 4px; 
            font-size: 12px; 
            font-weight: bold; 
        }
        
        .impact-medium { 
            background: #fef5e7; 
            color: #d69e2e; 
            padding: 4px 8px; 
            border-radius: 4px; 
            font-size: 12px; 
            font-weight: bold; 
        }
        
        .impact-low { 
            background: #c6f6d5; 
            color: #2f855a; 
            padding: 4px 8px; 
            border-radius: 4px; 
            font-size: 12px; 
            font-weight: bold; 
        }
    </style>
</body>
</html>
